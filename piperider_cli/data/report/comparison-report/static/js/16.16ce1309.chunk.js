"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(e,n,t){t.r(n),t.d(n,{default:function(){return A}});var i=t(8735),r=t(6837),a=t(4385),s=t(8625),l=t(3765),d=t(2483),o=t(2791),c=t(8453),u=t(9227),h=t(1971),x=t(9842);var v=t(184);function f(e){var n=e.data,t=(0,o.useRef)(null),r=(0,o.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,o.useEffect)((function(){if(n&&i&&t){var e=u.Ys(n.current),r=u.tiA().domain(t.map((function(e){return e.label}))).range([0,i.width]).padding(.05),a=u.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(a);var s=u.BYU().domain([0,u.Fp7(t,(function(e){return e.value}))]).range([i.height,0]),l=u.y4O(s);e.select(".y-axis").call(l),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return r(e.label)})).attr("y",(function(e){return s(e.value)})).attr("width",r.bandwidth()).attr("height",(function(e){return i.height-s(e.value)})).style("fill","var(--chakra-colors-blue-300)");var d=(0,x.v)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n,i=t.label,r=t.value,a=t.total;d.html("\n          <div>\n            <p>Label: ".concat(i,"</p>\n            <p>Count: ").concat((0,h.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/a*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),u.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){d.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){d.html("").transition().duration(500).style("visibility","hidden"),u.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,i,t])}({target:t,data:n,dimensions:(0,c.y)(r)}),(0,v.jsx)(i.kC,{className:"chart",width:"100%",ref:r,children:(0,v.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,v.jsx)("g",{className:"x-axis"}),(0,v.jsx)("g",{className:"y-axis"})]})})}var m=t(6108),j=t(5272),p=t(8662),g=t(709),b=t(972),y=t(6523),k=function(e){var n=e.column;return(0,y.h5)(y.a$.safeParse(n)),(0,v.jsxs)(i.kC,{direction:"column",gap:3,children:[(0,v.jsxs)(i.xu,{maxWidth:"100%",children:[(0,v.jsxs)(i.kC,{children:[(0,v.jsx)(i.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:n.name,noOfLines:1,children:n.name}),(0,v.jsx)(b.l,{label:n.description,prefix:" - via ",placement:"right-end",children:(0,v.jsx)(j.hQ,{m:"auto 0"})})]}),"","(",(0,v.jsx)(i.EK,{children:n.schema_type}),")"]}),(0,v.jsx)(i.kC,{direction:"column",mt:3,children:(0,v.jsx)(g.H,{baseColumn:n})}),"string"===n.type&&n.distribution&&(0,v.jsx)(i.kC,{direction:"column",children:(0,v.jsx)(m.$,{name:"Most common",base:(0,h.qW)(n),baseWidth:"200px"})}),"numeric"===n.type&&(0,v.jsx)(p.D,{baseColumn:n}),"datetime"===n.type&&(0,v.jsxs)(i.kC,{direction:"column",children:[(0,v.jsx)(m.$,{name:"Min",base:n.min}),(0,v.jsx)(m.$,{name:"Max",base:n.max})]})]})};function C(e){var n=e.data;return(0,v.jsx)(i.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e];(0,y.h5)(y.a$.safeParse(t));var r=t.distribution;return(0,v.jsxs)(i.kC,{direction:"column",px:4,children:[(0,v.jsxs)(i.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,v.jsx)(k,{column:t}),(0,v.jsx)(i.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,v.jsx)(f,{data:r.labels.map((function(e,n){return{label:e,value:r.counts[n],total:t.total}}))}):(0,v.jsx)(i.xv,{children:"No data available"})})]}),(0,v.jsx)(i.iz,{my:4})]},e)}))})}var T=t(7005),$=t(4821),w=t(9201);function O(e){var n=e.assertionData,t=e.type,r=void 0===t?"piperider":t,a=null===n||void 0===n?void 0:n.tests,s=null===n||void 0===n?void 0:n.columns;return!a||0===a.length&&0===Object.keys(s).length?(0,v.jsx)(i.kC,{direction:"column",children:(0,v.jsx)(i.xv,{textAlign:"center",children:"No tests available"})}):(0,v.jsx)(i.kC,{direction:"column",gap:4,children:(0,v.jsx)(T.xJ,{children:(0,v.jsxs)(T.iA,{variant:"simple",children:[(0,v.jsx)(T.hr,{children:(0,v.jsxs)(T.Tr,{children:[(0,v.jsx)(T.Th,{children:"Level"}),(0,v.jsx)(T.Th,{children:"Column"}),(0,v.jsx)(T.Th,{children:"Assertion"}),(0,v.jsx)(T.Th,{children:"Status"}),"piperider"===r&&(0,v.jsx)(T.Th,{children:"Expected"}),"piperider"===r&&(0,v.jsx)(T.Th,{children:"Actual"})]})}),(0,v.jsxs)(T.p3,{children:[a.map((function(e){(0,y.h5)($.S1.safeParse(e));var n="failed"===e.status;return(0,v.jsxs)(T.Tr,{children:[(0,v.jsx)(T.Td,{children:"Table"}),(0,v.jsx)(T.Td,{children:"-"}),(0,v.jsx)(T.Td,{children:e.name}),(0,v.jsx)(T.Td,{children:n?(0,v.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)(T.Td,{children:(0,h.sG)(e.expected)}),"piperider"===r&&(0,v.jsx)(T.Td,{color:n?"red.500":"inherit",children:(0,h.sG)(e.actual)})]},e.name)})),Object.keys(s).map((function(e){var n=s[e];return(0,y.h5)(w.z.array($.S1).safeParse(n)),n.map((function(n){var t="failed"===n.status;return(0,v.jsxs)(T.Tr,{children:[(0,v.jsx)(T.Td,{children:"Column"}),(0,v.jsx)(T.Td,{children:e}),(0,v.jsx)(T.Td,{children:n.name}),(0,v.jsx)(T.Td,{children:t?(0,v.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)(T.Td,{children:(0,h.sG)(n.expected)}),"piperider"===r&&(0,v.jsx)(T.Td,{color:t?"red.500":"inherit",children:(0,h.sG)(n.actual)})]},n.name)}))}))]})]})})})}var _=t(6157);function P(e){var n=e.table;(0,y.h5)(y.vT.safeParse(n));var t=(0,_.YI)(n.piperider_assertion_result,n.dbt_assertion_result);return(0,v.jsxs)(i.kC,{direction:"column",gap:4,mb:8,children:[(0,v.jsx)(i.X6,{size:"lg",children:"Overview"}),(0,v.jsxs)(i.xv,{children:["Table:"," ",(0,v.jsx)(i.xv,{as:"span",fontWeight:700,children:n.name})]}),(0,v.jsxs)(i.xv,{children:["Rows:"," ",(0,v.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,h.uf)(n.row_count)})]}),(0,v.jsxs)(i.xv,{children:["Columns:"," ",(0,v.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,h.uf)(n.col_count)})]}),(0,v.jsxs)(i.xv,{children:["Test Status:"," ",(0,v.jsx)(i.xv,{as:"span",fontWeight:700,children:t.passed})," ","Passed,"," ",(0,v.jsx)(i.xv,{as:"span",fontWeight:700,color:t.failed>0?"red.500":"inherit",children:t.failed})," ","Failed"]})]})}function A(e){var n=e.data,t=e.name,o=n.datasource,c=n.tables[t];return(0,y.h5)(y.vT.safeParse(c)),(0,y.h5)($.U0.safeParse(o)),(0,d.j)(t),n?(0,v.jsx)(l.o,{children:(0,v.jsxs)(i.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,v.jsx)(i.kC,{mx:"10%",mt:4,children:(0,v.jsxs)(r.aG,{fontSize:"lg",children:[(0,v.jsx)(r.gN,{children:(0,v.jsx)(s.rU,{href:"/",children:(0,v.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:o.name})})}),(0,v.jsx)(r.gN,{isCurrentPage:!0,children:(0,v.jsx)(r.At,{href:"#",children:c.name})})]})}),(0,v.jsxs)(i.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,v.jsx)(P,{table:c}),(0,v.jsxs)(a.mQ,{isLazy:!0,children:[(0,v.jsxs)(a.td,{children:[(0,v.jsx)(a.OK,{children:"Profiling"}),(0,v.jsx)(a.OK,{"data-cy":"sr-report-tab-item",children:"Tests"}),c.dbt_assertion_result&&(0,v.jsx)(a.OK,{children:"dbt Tests"})]}),(0,v.jsxs)(a.nP,{children:[(0,v.jsx)(a.x4,{children:(0,v.jsx)(C,{data:c.columns})}),(0,v.jsx)(a.x4,{children:(0,v.jsx)(O,{assertionData:c.piperider_assertion_result})}),(null===c||void 0===c?void 0:c.dbt_assertion_result)&&(0,v.jsx)(a.x4,{children:(0,v.jsx)(O,{type:"dbt",assertionData:c.dbt_assertion_result})})]})]})]})]})}):(0,v.jsx)(l.o,{children:(0,v.jsx)(i.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(e,n,t){t.d(n,{H:function(){return d}});var i=t(6523),r=t(1971),a=t(922),s=t(6108),l=t(184);function d(e){var n=e.baseColumn,t=e.targetColumn;if(n){(0,i.h5)(i.a$.safeParse(n));var d=(0,a.gQ)(n),o=d.totalOfTotal,c=d.valid,u=d.total,h=d.mismatch,x=d.missing,v=d.mismatchOfTotal,f=d.validOfTotal,m=d.missingOfTotal}if(t){(0,i.h5)(i.a$.safeParse(t));var j=(0,a.gQ)(t),p=j.total,g=j.mismatchOfTotal,b=j.validOfTotal,y=j.missingOfTotal}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.$,{name:"Total",base:(0,r.uy)(u,r.uf),target:(0,r.uy)(t?p:o,t?r.uf:r.Zn)}),(0,l.jsx)(s.$,{name:"Valid",base:(0,r.uy)(t?f:c,t?r.Zn:r.uf),target:(0,r.uy)(t?b:f,r.Zn)}),(0,l.jsx)(s.$,{name:"Mismatched",base:(0,r.uy)(t?v:h,t?r.Zn:r.uf),target:(0,r.uy)(t?g:v,r.Zn)}),(0,l.jsx)(s.$,{name:"Missing",base:(0,r.uy)(t?m:x,t?r.Zn:r.uf),target:(0,r.uy)(t?y:m,r.Zn)}),(0,l.jsx)(s.$,{name:"Distinct",base:(0,r.uy)(null===n||void 0===n?void 0:n.distinct,r.uf),target:t&&(0,r.uy)(null===t||void 0===t?void 0:t.distinct,r.uf)})]})}},6108:function(e,n,t){t.d(n,{$:function(){return a}});var i=t(8735),r=t(184);function a(e){var n=e.name,t=e.base,a=e.target,s=void 0===a?null:a,l=e.baseWidth,d=void 0===l?"100px":l,o=e.targetWidth,c=void 0===o?"100px":o;return(0,r.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,r.jsx)(i.xv,{fontWeight:700,children:n}),(0,r.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(i.xv,{textAlign:"right",width:d,noOfLines:1,children:t}),s&&(0,r.jsx)(i.xv,{textAlign:"right",width:c,children:s})]})]})}},8662:function(e,n,t){t.d(n,{D:function(){return d}});var i=t(8735),r=t(6523),a=t(1971),s=t(6108),l=t(184);function d(e){var n=e.baseColumn,t=e.targetColumn;return(0,r.h5)(r.a$.safeParse(n)),(0,r.h5)(r.a$.safeParse(n)),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(s.$,{name:"Average",base:(0,a.uy)(null===n||void 0===n?void 0:n.avg,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.avg,a.uf)}),(0,l.jsx)(s.$,{name:"Std. Deviation",base:(0,a.uy)(null===n||void 0===n?void 0:n.stddev,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.stddev,a.uf)})]}),(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(s.$,{name:"Min",base:(0,a.uy)(null===n||void 0===n?void 0:n.min,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.min,a.uf)}),(0,l.jsx)(s.$,{name:"5%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p5,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.p5,a.uf)}),(0,l.jsx)(s.$,{name:"25%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p25,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.p25,a.uf)}),(0,l.jsx)(s.$,{name:"50%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p50,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.p50,a.uf)}),(0,l.jsx)(s.$,{name:"75%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p75,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.p75,a.uf)}),(0,l.jsx)(s.$,{name:"95%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p95,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.p95,a.uf)}),(0,l.jsx)(s.$,{name:"Max",base:(0,a.uy)(null===n||void 0===n?void 0:n.max,a.uf),target:t&&(0,a.uy)(null===t||void 0===t?void 0:t.max,a.uf)})]})]})}},8453:function(e,n,t){t.d(n,{y:function(){return a}});var i=t(885),r=t(2791);function a(e){var n=(0,r.useState)(null),t=(0,i.Z)(n,2),a=t[0],s=t[1];return(0,r.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){s(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),a}},9842:function(e,n,t){t.d(n,{v:function(){return u}});var i=t(9227),r="var(--chakra-space-2)",a="var(--chakra-space-2)",s="var(--chakra-space-4)",l="var(--chakra-space-4)",d="var(--chakra-radii-md)",o="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(e){var n=e.target,t=e.style,u=void 0===t?{}:t;return i.Ys(n).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||r).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||a).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||d).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||s).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||l).style("color",(null===u||void 0===u?void 0:u.color)||o).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}}}]);
//# sourceMappingURL=16.16ce1309.chunk.js.map