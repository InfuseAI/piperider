"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});var i=t(8735),r=t(6837),s=t(4385),a=t(8625),l=t(3765),o=t(2483),d=t(2791),c=t(8453),u=t(5251),h=t(1971),v=t(9842);var x=t(184);function f(e){var n=e.data,t=(0,d.useRef)(null),r=(0,d.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,d.useEffect)((function(){if(n&&i&&t){var e=u.Ys(n.current),r=u.tiA().domain(t.map((function(e){return e.label}))).range([0,i.width]).padding(.05),s=u.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(s);var a=u.BYU().domain([0,u.Fp7(t,(function(e){return e.value}))]).range([i.height,0]),l=u.y4O(a);e.select(".y-axis").call(l),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return r(e.label)})).attr("y",(function(e){return a(e.value)})).attr("width",r.bandwidth()).attr("height",(function(e){return i.height-a(e.value)})).style("fill","var(--chakra-colors-blue-300)");var o=(0,v.v)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n,i=t.label,r=t.value,s=t.total;o.html("\n          <div>\n            <p>Label: ".concat(i,"</p>\n            <p>Count: ").concat((0,h.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),u.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){o.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){o.html("").transition().duration(500).style("visibility","hidden"),u.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,i,t])}({target:t,data:n,dimensions:(0,c.y)(r)}),(0,x.jsx)(i.kC,{className:"chart",width:"100%",ref:r,children:(0,x.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,x.jsx)("g",{className:"x-axis"}),(0,x.jsx)("g",{className:"y-axis"})]})})}var m=t(511),j=t(5272),p=t(8662),g=t(709),y=t(972),b=t(6523),S=function(e){var n=e.column;return(0,b.h5)(b.a$.safeParse(n)),(0,x.jsxs)(i.kC,{direction:"column",gap:3,children:[(0,x.jsxs)(i.xu,{maxWidth:"100%",children:[(0,x.jsxs)(i.kC,{children:[(0,x.jsx)(i.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:n.name,noOfLines:1,children:n.name}),(0,x.jsx)(y.l,{label:n.description,prefix:" - via ",placement:"right-end",children:(0,x.jsx)(j.hQ,{m:"auto 0"})})]}),"","(",(0,x.jsx)(i.EK,{children:n.schema_type}),")"]}),(0,x.jsx)(i.kC,{direction:"column",mt:3,children:(0,x.jsx)(g.H,{baseColumn:n})}),"string"===n.type&&n.distribution&&(0,x.jsx)(i.kC,{direction:"column",children:(0,x.jsx)(m.$,{name:"Most common",firstSlot:(0,h.qW)(n),firstSlotWidth:"200px"})}),"numeric"===n.type&&(0,x.jsx)(p.D,{baseColumn:n}),"datetime"===n.type&&(0,x.jsxs)(i.kC,{direction:"column",children:[(0,x.jsx)(m.$,{name:"Min",firstSlot:n.min}),(0,x.jsx)(m.$,{name:"Max",firstSlot:n.max})]})]})};function k(e){var n=e.data;return(0,x.jsx)(i.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e];(0,b.h5)(b.a$.safeParse(t));var r=t.distribution;return(0,x.jsxs)(i.kC,{direction:"column",px:4,children:[(0,x.jsxs)(i.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,x.jsx)(S,{column:t}),(0,x.jsx)(i.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,x.jsx)(f,{data:r.labels.map((function(e,n){return{label:e,value:r.counts[n],total:t.total}}))}):(0,x.jsx)(i.xv,{children:"No data available"})})]}),(0,x.jsx)(i.iz,{my:4})]},e)}))})}var C=t(7005),T=t(4821),$=t(9201);function w(e){var n=e.assertionData,t=e.type,r=void 0===t?"piperider":t,s=null===n||void 0===n?void 0:n.tests,a=(null===n||void 0===n?void 0:n.columns)||{};return!s||0===s.length&&0===Object.keys(a).length?(0,x.jsx)(i.kC,{direction:"column",children:(0,x.jsx)(i.xv,{textAlign:"center",children:"No tests available"})}):(0,x.jsx)(i.kC,{direction:"column",gap:4,children:(0,x.jsx)(C.xJ,{children:(0,x.jsxs)(C.iA,{variant:"simple",children:[(0,x.jsx)(C.hr,{children:(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Th,{children:"Level"}),(0,x.jsx)(C.Th,{children:"Column"}),(0,x.jsx)(C.Th,{children:"Assertion"}),(0,x.jsx)(C.Th,{children:"Status"}),"piperider"===r&&(0,x.jsx)(C.Th,{children:"Expected"}),"piperider"===r&&(0,x.jsx)(C.Th,{children:"Actual"})]})}),(0,x.jsxs)(C.p3,{children:[s.map((function(e){(0,b.h5)(T.S1.safeParse(e));var n="failed"===e.status;return(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Td,{children:"Table"}),(0,x.jsx)(C.Td,{children:"-"}),(0,x.jsx)(C.Td,{children:e.name}),(0,x.jsx)(C.Td,{children:n?(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,x.jsx)(C.Td,{children:(0,h.sG)(e.expected)}),"piperider"===r&&(0,x.jsx)(C.Td,{color:n?"red.500":"inherit",children:(0,h.sG)(e.actual)})]},e.name)})),Object.keys(a).map((function(e){var n=a[e];return(0,b.h5)($.z.array(T.S1).safeParse(n)),n.map((function(n){var t="failed"===n.status;return(0,x.jsxs)(C.Tr,{children:[(0,x.jsx)(C.Td,{children:"Column"}),(0,x.jsx)(C.Td,{children:e}),(0,x.jsx)(C.Td,{children:n.name}),(0,x.jsx)(C.Td,{children:t?(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,x.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,x.jsx)(C.Td,{children:(0,h.sG)(n.expected)}),"piperider"===r&&(0,x.jsx)(C.Td,{color:t?"red.500":"inherit",children:(0,h.sG)(n.actual)})]},n.name)}))}))]})]})})})}var O=t(6157);function _(e){var n=e.table;(0,b.h5)(b.vT.safeParse(n));var t=(0,O.YI)(n.piperider_assertion_result,n.dbt_assertion_result);return(0,x.jsxs)(i.kC,{direction:"column",gap:4,mb:8,children:[(0,x.jsx)(i.X6,{size:"lg",children:"Overview"}),(0,x.jsxs)(i.xv,{children:["Table:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:n.name})]}),(0,x.jsxs)(i.xv,{children:["Rows:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,h.uf)(n.row_count)})]}),(0,x.jsxs)(i.xv,{children:["Columns:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,h.uf)(n.col_count)})]}),(0,x.jsxs)(i.xv,{children:["Test Status:"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,children:t.passed})," ","Passed,"," ",(0,x.jsx)(i.xv,{as:"span",fontWeight:700,color:t.failed>0?"red.500":"inherit",children:t.failed})," ","Failed"]})]})}function P(e){var n=e.data,t=e.name,d=n.datasource,c=n.tables[t];return(0,b.h5)(b.vT.safeParse(c)),(0,b.h5)(T.U0.safeParse(d)),(0,o.j)(t),n?(0,x.jsx)(l.o,{children:(0,x.jsxs)(i.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,x.jsx)(i.kC,{mx:"10%",mt:4,children:(0,x.jsxs)(r.aG,{fontSize:"lg",children:[(0,x.jsx)(r.gN,{children:(0,x.jsx)(a.rU,{href:"/",children:(0,x.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:d.name})})}),(0,x.jsx)(r.gN,{isCurrentPage:!0,children:(0,x.jsx)(r.At,{href:"#",children:c.name})})]})}),(0,x.jsxs)(i.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,x.jsx)(_,{table:c}),(0,x.jsxs)(s.mQ,{isLazy:!0,children:[(0,x.jsxs)(s.td,{children:[(0,x.jsx)(s.OK,{children:"Profiling"}),(0,x.jsx)(s.OK,{"data-cy":"sr-report-tab-item",children:"Tests"}),c.dbt_assertion_result&&(0,x.jsx)(s.OK,{children:"dbt Tests"})]}),(0,x.jsxs)(s.nP,{children:[(0,x.jsx)(s.x4,{children:(0,x.jsx)(k,{data:c.columns})}),(0,x.jsx)(s.x4,{children:(0,x.jsx)(w,{assertionData:c.piperider_assertion_result})}),(null===c||void 0===c?void 0:c.dbt_assertion_result)&&(0,x.jsx)(s.x4,{children:(0,x.jsx)(w,{type:"dbt",assertionData:c.dbt_assertion_result})})]})]})]})]})}):(0,x.jsx)(l.o,{children:(0,x.jsx)(i.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(e,n,t){t.d(n,{H:function(){return o}});var i=t(6523),r=t(1971),s=t(922),a=t(511),l=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn;if(n){(0,i.h5)(i.a$.safeParse(n));var o=(0,s.gQ)(n),d=o.totalOfTotal,c=o.valid,u=o.total,h=o.mismatch,v=o.missing,x=o.mismatchOfTotal,f=o.validOfTotal,m=o.missingOfTotal,j=o.distinctOfTotal}if(t){(0,i.h5)(i.a$.safeParse(t));var p=(0,s.gQ)(t),g=p.total,y=p.mismatchOfTotal,b=p.validOfTotal,S=p.missingOfTotal,k=p.distinctOfTotal}var C=null===t,T="-";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.$,{name:"Total",firstSlot:(0,r.uy)(u,r.uf),secondSlot:C?T:(0,r.uy)(t?g:d,t?r.uf:r.Zn)}),(0,l.jsx)(a.$,{name:"Valid",firstSlot:(0,r.uy)(t?f:c,t?r.Zn:r.uf),secondSlot:C?T:(0,r.uy)(t?b:f,r.Zn)}),(0,l.jsx)(a.$,{name:"Mismatched",firstSlot:(0,r.uy)(t?x:h,t?r.Zn:r.uf),secondSlot:C?T:(0,r.uy)(t?y:x,r.Zn)}),(0,l.jsx)(a.$,{name:"Missing",firstSlot:(0,r.uy)(t?m:v,t?r.Zn:r.uf),secondSlot:C?T:(0,r.uy)(t?S:m,r.Zn)}),(0,l.jsx)(a.$,{name:"Distinct",firstSlot:(0,r.uy)(null===n||void 0===n?void 0:n.distinct,r.uf),secondSlot:C?T:(0,r.uy)(t?k:j,r.Zn)})]})}},511:function(e,n,t){t.d(n,{$:function(){return s}});var i=t(8735),r=t(184);function s(e){var n=e.name,t=e.firstSlot,s=e.secondSlot,a=e.firstSlotWidth,l=void 0===a?"100px":a,o=e.secondSlotWidth,d=void 0===o?"100px":o;return(0,r.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,r.jsx)(i.xv,{fontWeight:700,children:n}),(0,r.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(i.xv,{textAlign:"right",width:l,noOfLines:1,children:t}),s&&(0,r.jsx)(i.xv,{textAlign:"right",width:d,children:s})]})]})}},8662:function(e,n,t){t.d(n,{D:function(){return o}});var i=t(8735),r=t(6523),s=t(1971),a=t(511),l=t(184);function o(e){var n=e.baseColumn,t=e.targetColumn,o=null===t,d=void 0===t,c="-";return(0,r.h5)(r.a$.safeParse(n)),(0,r.h5)(r.a$.safeParse(n)),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Average",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.avg,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.avg,s.uf)}),(0,l.jsx)(a.$,{name:"Std. Deviation",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.stddev,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.stddev,s.uf)})]}),(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Min",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.min,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.min,s.uf)}),(0,l.jsx)(a.$,{name:"5%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p5,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p5,s.uf)}),(0,l.jsx)(a.$,{name:"25%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p25,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p25,s.uf)}),(0,l.jsx)(a.$,{name:"50%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p50,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p50,s.uf)}),(0,l.jsx)(a.$,{name:"75%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p75,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p75,s.uf)}),(0,l.jsx)(a.$,{name:"95%",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.p95,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.p95,s.uf)}),(0,l.jsx)(a.$,{name:"Max",firstSlot:(0,s.uy)(null===n||void 0===n?void 0:n.max,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===t||void 0===t?void 0:t.max,s.uf)})]})]})}},8453:function(e,n,t){t.d(n,{y:function(){return s}});var i=t(885),r=t(2791);function s(e){var n=(0,r.useState)(null),t=(0,i.Z)(n,2),s=t[0],a=t[1];return(0,r.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){a(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),s}},9842:function(e,n,t){t.d(n,{v:function(){return u}});var i=t(5251),r="var(--chakra-space-2)",s="var(--chakra-space-2)",a="var(--chakra-space-4)",l="var(--chakra-space-4)",o="var(--chakra-radii-md)",d="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(e){var n=e.target,t=e.style,u=void 0===t?{}:t;return i.Ys(n).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||r).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||s).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||o).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||a).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||l).style("color",(null===u||void 0===u?void 0:u.color)||d).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}}}]);
//# sourceMappingURL=16.d7202414.chunk.js.map