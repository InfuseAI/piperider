"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[826],{5826:function(n,e,i){i.r(e),i.d(e,{default:function(){return Q}});var t=i(1413),l=i(885),s=i(5223),r=i(8735),a=i(6837),d=i(4385),o=i(8625),c=i(2791),u=i(3765),v=i(6157),h=i(2483),x=i(5987),f=i(1564),j=i(2504),m=i(7005),g=i(184);function p(n){switch(n.status){case"passed":return(0,g.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,g.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,g.jsx)(r.xv,{as:"span",role:"img",children:"-"})}}function b(n){var e,i,t,l,s,r,a=n.data;return(0,g.jsx)(m.xJ,{children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{}),(0,g.jsx)(m.Th,{children:"Status"}),(0,g.jsx)(m.Th,{children:"Message"})]})}),(0,g.jsxs)(m.p3,{children:[(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===a||void 0===a||null===(e=a.base)||void 0===e?void 0:e.status})}),(0,g.jsx)(m.Td,{children:null!==(i=null===a||void 0===a||null===(t=a.base)||void 0===t?void 0:t.message)&&void 0!==i?i:"-"})]}),(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,g.jsx)(m.Td,{children:null!==(s=null===a||void 0===a||null===(r=a.base)||void 0===r?void 0:r.message)&&void 0!==s?s:"-"})]})]})]})})}var T=i(1971);function y(n){var e,i,t,l,s,r,a=n.data;return(0,g.jsx)(m.xJ,{children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{}),(0,g.jsx)(m.Th,{children:"Status"}),(0,g.jsx)(m.Th,{children:"Expected"}),(0,g.jsx)(m.Th,{children:"Actual"})]})}),(0,g.jsxs)(m.p3,{children:[(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===a||void 0===a||null===(e=a.base)||void 0===e?void 0:e.status})}),(0,g.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.expected)}),(0,g.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(t=a.base)||void 0===t?void 0:t.actual)})]}),(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,g.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(s=a.target)||void 0===s?void 0:s.expected)}),(0,g.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.actual)})]})]})]})})}var C=["data","type","isOpen","onClose"];function S(n){var e=n.data,i=n.type,l=void 0===i?"piperider":i,s=n.isOpen,a=n.onClose,d=(0,x.Z)(n,C);return(0,g.jsxs)(f.u_,(0,t.Z)((0,t.Z)({},d),{},{isOpen:s,size:"2xl",onClose:function(){a()},children:[(0,g.jsx)(f.ZA,{}),(0,g.jsxs)(f.hz,{children:[(0,g.jsx)(f.xB,{children:(0,g.jsx)(r.xv,{title:null===e||void 0===e?void 0:e.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===e||void 0===e?void 0:e.name})}),(0,g.jsx)(f.ol,{}),(0,g.jsx)(f.fe,{children:"piperider"===l?(0,g.jsx)(y,{data:e}):(0,g.jsx)(b,{data:e})}),(0,g.jsx)(f.mz,{children:(0,g.jsx)(j.zx,{onClick:a,children:"Close"})})]})]}))}var k=i(6523),Z=i(922),O=i(8453),w=i(5251),A=i(9842),_=["base","target"];function $(n){var e=n.data,i=(0,c.useRef)(null),t=(0,c.useRef)(null);return function(n){var e=n.target,i=n.data,t=n.dimensions;(0,c.useEffect)((function(){if(e&&t&&i){var n=w.Ys(e.current),l=i.map((function(n){return n.label||""})),s=w.tiA().domain(l).range([0,t.width]).padding(.2),r=w.tiA().domain(_).range([0,s.bandwidth()]).padding(.05),a=w.LLu(s).tickFormat((function(n,e){var i=s.domain().length-1;return 0===e||e===i/2||e===i?n:""}));n.select(".x-axis").style("transform","translateY(".concat(t.height,"px)")).call(a);var d=w.BYU().domain([0,w.Fp7(i,(function(n){var e=n.base,i=n.target;return Math.max(e,i)}))]).range([t.height,0]),o=w.y4O(d);n.select(".y-axis").call(o);var c=w.PKp().domain(_).range(["var(--chakra-colors-blue-100)","var(--chakra-colors-blue-300)"]),u=n.selectAll(".grouped-chart").data(i).join("g").attr("class","grouped-chart").attr("transform",(function(n){return"translate(".concat(s(n.label),", 0)")})),v=(0,A.v)({target:".chart"});return u.selectAll("rect").data((function(n){return _.map((function(e){return{key:e,label:n.label,value:n[e]}}))})).enter().append("rect").attr("x",(function(n){return r(n.key)})).attr("y",(function(n){return d(n.value)})).attr("width",(function(n){return r.bandwidth()})).attr("height",(function(n){return t.height-d(n.value)})).attr("fill",(function(n){return c(n.key)})),u.selectAll(".overlay-bars").data((function(n){return _.map((function(e){return{key:e,label:n.label,value:n[e]}}))})).join("rect").attr("class","overlay-bars").attr("x",(function(n){return r(n.key)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return t.height})).attr("fill",(function(n){return c(n.key)})).style("opacity",0).on("mouseover",(function(n,e){v.html("\n        <div>\n          <p>Label: ".concat(e.label,"</p>\n          <p>Count: ").concat((0,T.uf)(e.value),"</p>\n        </div>\n      ")).transition().duration(500).style("visibility","visible"),w.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(n){v.style("top","".concat(n.pageY-10,"px")).style("left","".concat(n.pageX+10,"px"))})).on("mouseout",(function(){v.html("").transition().duration(500).style("visibility","hidden"),w.Ys(this).style("opacity",0)})),function(){n.select("svg").remove()}}}),[i,t,e])}({target:i,data:e,dimensions:(0,O.y)(t)}),(0,g.jsx)(r.kC,{className:"chart",width:"100%",ref:t,children:(0,g.jsxs)("svg",{width:"100%",overflow:"visible",ref:i,children:[(0,g.jsx)("g",{className:"x-axis"}),(0,g.jsx)("g",{className:"y-axis"})]})})}var P=i(709),W=i(511),N=i(8662),L=function(n){var e,i,t,l,s=n.baseColumn,a=n.targetColumn,d="-",o=s||a;return(0,k.h5)(k.a$.safeParse(s)),(0,k.h5)(k.a$.safeParse(a)),(0,g.jsx)(r.kC,{direction:"column",gap:2,minH:"250px",children:(0,g.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,g.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,g.jsxs)(r.xv,{maxWidth:"calc(100% - 250px)",children:[(0,g.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,noOfLines:1,title:null===o||void 0===o?void 0:o.name,children:null===o||void 0===o?void 0:o.name}),"","(",(0,g.jsx)(r.EK,{children:null===o||void 0===o?void 0:o.schema_type}),")"]}),(0,g.jsxs)(r.kC,{gap:8,children:[(0,g.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,g.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]})]}),(0,g.jsx)(r.kC,{direction:"column",mt:3,children:(0,g.jsx)(P.H,{baseColumn:s,targetColumn:a||null})}),"numeric"===(null===s||void 0===s?void 0:s.type)&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(N.D,{baseColumn:s,targetColumn:a||null})}),"datetime"===(null===s||void 0===s?void 0:s.type)&&(0,g.jsxs)(r.kC,{direction:"column",children:[(0,g.jsx)(W.$,{name:"Min",firstSlot:null!==(e=null===s||void 0===s?void 0:s.min)&&void 0!==e?e:d,secondSlot:null!==(i=null===a||void 0===a?void 0:a.min)&&void 0!==i?i:d}),(0,g.jsx)(W.$,{name:"Max",firstSlot:null!==(t=null===s||void 0===s?void 0:s.max)&&void 0!==t?t:d,secondSlot:null!==(l=null===a||void 0===a?void 0:a.max)&&void 0!==l?l:d})]})]})})};function z(n){var e=n.baseTable,i=n.targetTable;(0,k.h5)(k.vT.safeParse(e)),(0,k.h5)(k.vT.safeParse(i));var t=(0,Z.WN)(null===e||void 0===e?void 0:e.columns,null===i||void 0===i?void 0:i.columns);return(0,g.jsx)(g.Fragment,{children:Object.entries(t).map((function(n){var e=(0,l.Z)(n,2),i=e[0],t=e[1];return(0,g.jsx)(F,{name:i,base:null===t||void 0===t?void 0:t.base,target:null===t||void 0===t?void 0:t.target},i)}))})}function F(n){var e=n.name,i=n.base,t=n.target,s=(0,c.useState)([]),a=(0,l.Z)(s,2),d=a[0],o=a[1];(0,c.useEffect)((function(){if((null===i||void 0===i?void 0:i.type)!==(null===t||void 0===t?void 0:t.type)||"string"!==(null===i||void 0===i?void 0:i.type)&&"datetime"!==(null===i||void 0===i?void 0:i.type)){var n=null!==i&&void 0!==i&&i.distribution?(0,Z.Fo)({baseCounts:i.distribution.counts,baseLabels:i.distribution.labels}):null,e=null!==t&&void 0!==t&&t.distribution?(0,Z.Fo)({baseCounts:t.distribution.counts,baseLabels:t.distribution.labels}):null;o([n,e])}else{var l=(0,Z.NN)({base:null===i||void 0===i?void 0:i.distribution,target:null===t||void 0===t?void 0:t.distribution});o([l])}}),[i,t]);var u=1===d.length;return(0,g.jsx)(r.kC,{direction:"column",children:(0,g.jsxs)(r.rj,{my:8,templateColumns:"500px 1fr",gap:12,children:[(0,g.jsx)(L,{baseColumn:i,targetColumn:t}),(0,g.jsxs)(r.rj,{my:4,templateColumns:"1fr ".concat(u?"":"1fr"),gap:u?0:12,children:[d[0]?(0,g.jsx)($,{data:d[0]}):(0,g.jsx)(Y,{}),d[1]?(0,g.jsx)($,{data:d[1]}):u?null:(0,g.jsx)(Y,{})]})]})},e)}function Y(){return(0,g.jsx)(r.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var E=i(2982),M=i(5984),B=function(n,e){return n?Object.entries(n).map((function(n){var i=(0,l.Z)(n,2),s=i[0],r=i[1];return(0,t.Z)((0,t.Z)({},r),{},{key:s,type:e,changed:!1})})):[]};function D(n){var e=n.base,i=n.target;(0,k.h5)(k.vT.safeParse(e)),(0,k.h5)(k.vT.safeParse(i));var l="-",s=B(null===e||void 0===e?void 0:e.columns,"base"),a=B(null===i||void 0===i?void 0:i.columns,"target"),d=[].concat((0,E.Z)(s),(0,E.Z)(a)),o=a.length-s.length,c=o<0?0:o,u=s.length-a.length,v=u<0?0:u,h=d.reduce((function(n,e,i){var l,r,a=i<s.length?i:i-s.length,o=i>=s.length?i:i+s.length,c=(null===(l=d[a])||void 0===l?void 0:l.schema_type)!==(null===(r=d[o])||void 0===r?void 0:r.schema_type),u=n.changed+(c?1:0),v=(0,t.Z)((0,t.Z)({},e),{},{name:e.name,changed:c});return(0,t.Z)((0,t.Z)({},n),{},{changed:u,columns:[].concat((0,E.Z)(n.columns),[v])})}),{added:c,deleted:v,changed:0,columns:[]}),x=h.added,f=h.deleted,j=h.changed,p=h.columns,b=p.slice(0,s.length),T=p.slice(s.length),y=R(b,T,o),C=R(T,b,u);return(0,g.jsxs)(r.kC,{direction:"column",children:[(0,g.jsxs)(r.xv,{mb:4,p:2,children:["Added:",(0,g.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:x}),", Deleted:",(0,g.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:f}),", Changed:"," ",(0,g.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:j})]}),(0,g.jsxs)(r.kC,{justifyContent:"space-evenly",children:[(0,g.jsx)(m.xJ,{width:"50%",children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{children:"Column"}),(0,g.jsx)(m.Th,{children:"Type"})]})}),(0,g.jsx)(m.p3,{children:y.map((function(n){var e,i;return(0,g.jsxs)(m.Tr,{color:null!==n&&void 0!==n&&n.changed?"red.500":"inherit",children:[(0,g.jsx)(m.Td,{children:null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:l}),(0,g.jsx)(m.Td,{children:null!==(i=null===n||void 0===n?void 0:n.schema_type)&&void 0!==i?i:l})]},(0,M.x0)(10))}))})]})}),(0,g.jsx)(r.kC,{justifyContent:"center",children:(0,g.jsx)(r.iz,{orientation:"vertical"})}),(0,g.jsx)(m.xJ,{width:"50%",children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{children:"Column"}),(0,g.jsx)(m.Th,{children:"Type"})]})}),(0,g.jsx)(m.p3,{children:C.map((function(n){var e,i;return(0,g.jsxs)(m.Tr,{color:null!==n&&void 0!==n&&n.changed?"red.500":"inherit",children:[(0,g.jsx)(m.Td,{children:null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:l}),(0,g.jsx)(m.Td,{children:null!==(i=null===n||void 0===n?void 0:n.schema_type)&&void 0!==i?i:l})]},(0,M.x0)(10))}))})]})})]})]})}function R(n,e,i){return n.length<e.length?[].concat((0,E.Z)(n),(0,E.Z)(Array(i).fill(null))):n}var I=i(8444),J=i.n(I),K=["base","target"];function G(n){var e=n.base,i=void 0===e?[]:e,t=n.target,l=void 0===t?[]:t,s=(0,x.Z)(n,K),a=J()([].concat((0,E.Z)(i),(0,E.Z)(l)),(function(n){return"".concat(n.level,"_").concat(n.column,"_").concat(n.name)})),d=Object.values(a).map((function(n){var e={level:n[0].level,column:n[0].column,name:n[0].name};return n.forEach((function(n){"base"===n.from?e.base=n:e.target=n})),e}));return 0===d.length?(0,g.jsx)(r.kC,{direction:"column",children:(0,g.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,g.jsx)(m.xJ,{children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{children:"Level"}),(0,g.jsx)(m.Th,{children:"Column"}),(0,g.jsx)(m.Th,{children:"Assertion"}),(0,g.jsx)(m.Th,{children:"Base Status"}),(0,g.jsx)(m.Th,{children:"Target Status"}),(0,g.jsx)(m.Th,{})]})}),(0,g.jsx)(m.p3,{children:Object.values(d).map((function(n){var e,i;return(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{children:n.level}),(0,g.jsx)(m.Td,{children:n.column}),(0,g.jsx)(m.Td,{children:n.name}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===(e=n.base)||void 0===e?void 0:e.status})}),(0,g.jsx)(m.Td,{children:(0,g.jsx)(p,{status:null===(i=n.target)||void 0===i?void 0:i.status})}),(0,g.jsx)(m.Td,{onClick:function(){s.onDetailVisible(n)},children:(0,g.jsx)(r.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,M.x0)())}))})]})})}function H(n){var e,i,t,l,s,a,d=n.baseTable,o=n.targetTable;(0,k.h5)(k.vT.safeParse(d)),(0,k.h5)(k.vT.safeParse(o));var c=(0,v.YI)(null===d||void 0===d?void 0:d.piperider_assertion_result,null===d||void 0===d?void 0:d.dbt_assertion_result),u=(0,v.YI)(null===o||void 0===o?void 0:o.piperider_assertion_result,null===o||void 0===o?void 0:o.dbt_assertion_result);return(0,g.jsx)(m.xJ,{children:(0,g.jsxs)(m.iA,{variant:"simple",children:[(0,g.jsx)(m.hr,{children:(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Th,{width:"10%"}),(0,g.jsx)(m.Th,{width:"45%",children:"Base"}),(0,g.jsx)(m.Th,{width:"45%",children:"Target"})]})}),(0,g.jsxs)(m.p3,{children:[(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{children:"Table"}),(0,g.jsx)(m.Td,{children:null!==(e=null===d||void 0===d?void 0:d.name)&&void 0!==e?e:"-"}),(0,g.jsx)(m.Td,{children:null!==(i=null===o||void 0===o?void 0:o.name)&&void 0!==i?i:"-"})]}),(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{children:"Rows"}),(0,g.jsx)(m.Td,{children:null!==(t=null===d||void 0===d?void 0:d.row_count)&&void 0!==t?t:"-"}),(0,g.jsx)(m.Td,{children:null!==(l=null===o||void 0===o?void 0:o.row_count)&&void 0!==l?l:"-"})]}),(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{children:"Columns"}),(0,g.jsx)(m.Td,{children:null!==(s=null===d||void 0===d?void 0:d.col_count)&&void 0!==s?s:"-"}),(0,g.jsx)(m.Td,{children:null!==(a=null===o||void 0===o?void 0:o.col_count)&&void 0!==a?a:"-"})]}),(0,g.jsxs)(m.Tr,{children:[(0,g.jsx)(m.Td,{children:"Test status"}),(0,g.jsx)(m.Td,{children:(0,g.jsxs)(r.xv,{children:[(0,g.jsxs)(r.xv,{as:"span",fontWeight:700,children:[c.passed," "]}),"Passed",", ",(0,g.jsxs)(r.xv,{as:"span",fontWeight:700,color:c.failed>0?"red.500":"inherit",children:[c.failed," "]}),"Failed"]})}),(0,g.jsx)(m.Td,{children:(0,g.jsxs)(r.xv,{children:[(0,g.jsxs)(r.xv,{as:"span",fontWeight:700,children:[u.passed," "]}),"Passed",", ",(0,g.jsxs)(r.xv,{as:"span",fontWeight:700,color:u.failed>0?"red.500":"inherit",children:[u.failed," "]}),"Failed"]})})]})]})]})})}function Q(n){var e,i=n.data,x=n.name,f=(0,c.useState)(null),j=(0,l.Z)(f,2),m=j[0],p=j[1],b=(0,s.qY)(),T=i.base,y=i.input;(0,k.h5)((0,k.C6)(!0).safeParse(i));var C=T.tables[x],Z=y.tables[x],O=null===(e=T.tables[x])||void 0===e?void 0:e.dbt_assertion_result;(0,k.h5)(k.vT.safeParse(C)),(0,k.h5)(k.vT.safeParse(Z));var w=(0,v.Ix)({data:i,reportName:x,type:"piperider"}),A=(0,l.Z)(w,2),_=A[0],$=A[1],P=(0,v.Ix)({data:i,reportName:x,type:"dbt"}),W=(0,l.Z)(P,2),N=W[0],L=W[1];return(0,h.j)(x),(0,g.jsxs)(u.o,{children:[(0,g.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,g.jsx)(r.kC,{mx:"10%",mt:4,children:(0,g.jsxs)(a.aG,{fontSize:"lg",children:[(0,g.jsx)(a.gN,{children:(0,g.jsx)(o.rU,{href:"/",children:(0,g.jsx)(a.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:"Tables"})})}),(0,g.jsx)(a.gN,{isCurrentPage:!0,children:(0,g.jsx)(a.At,{href:"#",children:x})})]})}),(0,g.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",gap:8,children:[(0,g.jsx)(r.X6,{fontSize:24,children:"Overview"}),(0,g.jsx)(H,{baseTable:C,targetTable:Z}),(0,g.jsxs)(d.mQ,{isLazy:!0,children:[(0,g.jsxs)(d.td,{children:[(0,g.jsx)(d.OK,{children:"Schema"}),(0,g.jsx)(d.OK,{"data-cy":"cr-report-tab-item-profiling",children:"Profiling"}),(0,g.jsx)(d.OK,{"data-cy":"cr-report-tab-item-tests",children:"Tests"}),O&&(0,g.jsx)(d.OK,{children:"dbt Tests"})]}),(0,g.jsxs)(d.nP,{children:[(0,g.jsx)(d.x4,{children:(0,g.jsx)(D,{base:C,target:Z})}),(0,g.jsx)(d.x4,{children:(0,g.jsx)(z,{baseTable:C,targetTable:Z})}),(0,g.jsx)(d.x4,{children:(0,g.jsx)(G,{base:null===_||void 0===_?void 0:_.tests,target:null===$||void 0===$?void 0:$.tests,onDetailVisible:function(n){p({type:"piperider",data:n}),b.onOpen()}})}),(0,g.jsx)(d.x4,{children:0===(null===N||void 0===N?void 0:N.tests.length)&&0===(null===L||void 0===L?void 0:L.tests.length)?(0,g.jsx)(r.kC,{justifyContent:"center",alignItems:"center",height:"100px",children:(0,g.jsx)(r.xv,{color:"gray.500",children:"No dbt tests available."})}):(0,g.jsx)(G,{base:null===N||void 0===N?void 0:N.tests,target:null===L||void 0===L?void 0:L.tests,onDetailVisible:function(n){p({type:"dbt",data:n}),b.onOpen()}})})]})]})]})]}),(0,g.jsx)(S,(0,t.Z)((0,t.Z)({},b),{},{type:null===m||void 0===m?void 0:m.type,data:null===m||void 0===m?void 0:m.data,onClose:function(){b.onClose(),p(null)}}))]})}},709:function(n,e,i){i.d(e,{H:function(){return d}});var t=i(6523),l=i(1971),s=i(922),r=i(511),a=i(184);function d(n){var e=n.baseColumn,i=n.targetColumn;if(e){(0,t.h5)(t.a$.safeParse(e));var d=(0,s.gQ)(e),o=d.totalOfTotal,c=d.valid,u=d.total,v=d.mismatch,h=d.missing,x=d.mismatchOfTotal,f=d.validOfTotal,j=d.missingOfTotal,m=d.distinctOfTotal}if(i){(0,t.h5)(t.a$.safeParse(i));var g=(0,s.gQ)(i),p=g.total,b=g.mismatchOfTotal,T=g.validOfTotal,y=g.missingOfTotal,C=g.distinctOfTotal}var S=null===i,k="-";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.$,{name:"Total",firstSlot:(0,l.uy)(u,l.uf),secondSlot:S?k:(0,l.uy)(i?p:o,i?l.uf:l.Zn)}),(0,a.jsx)(r.$,{name:"Valid",firstSlot:(0,l.uy)(i?f:c,i?l.Zn:l.uf),secondSlot:S?k:(0,l.uy)(i?T:f,l.Zn)}),(0,a.jsx)(r.$,{name:"Mismatched",firstSlot:(0,l.uy)(i?x:v,i?l.Zn:l.uf),secondSlot:S?k:(0,l.uy)(i?b:x,l.Zn)}),(0,a.jsx)(r.$,{name:"Missing",firstSlot:(0,l.uy)(i?j:h,i?l.Zn:l.uf),secondSlot:S?k:(0,l.uy)(i?y:j,l.Zn)}),(0,a.jsx)(r.$,{name:"Distinct",firstSlot:(0,l.uy)(null===e||void 0===e?void 0:e.distinct,l.uf),secondSlot:S?k:(0,l.uy)(i?C:m,l.Zn)})]})}},511:function(n,e,i){i.d(e,{$:function(){return s}});var t=i(8735),l=i(184);function s(n){var e=n.name,i=n.firstSlot,s=n.secondSlot,r=n.firstSlotWidth,a=void 0===r?"100px":r,d=n.secondSlotWidth,o=void 0===d?"100px":d;return(0,l.jsxs)(t.kC,{justifyContent:"space-between",children:[(0,l.jsx)(t.xv,{fontWeight:700,children:e}),(0,l.jsxs)(t.kC,{gap:{lg:5,md:1},children:[(0,l.jsx)(t.xv,{textAlign:"right",width:a,noOfLines:1,children:i}),s&&(0,l.jsx)(t.xv,{textAlign:"right",width:o,children:s})]})]})}},8662:function(n,e,i){i.d(e,{D:function(){return d}});var t=i(8735),l=i(6523),s=i(1971),r=i(511),a=i(184);function d(n){var e=n.baseColumn,i=n.targetColumn,d=null===i,o=void 0===i,c="-";return(0,l.h5)(l.a$.safeParse(e)),(0,l.h5)(l.a$.safeParse(e)),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.kC,{direction:"column",children:[(0,a.jsx)(r.$,{name:"Average",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.avg,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.avg,s.uf)}),(0,a.jsx)(r.$,{name:"Std. Deviation",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.stddev,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.stddev,s.uf)})]}),(0,a.jsxs)(t.kC,{direction:"column",children:[(0,a.jsx)(r.$,{name:"Min",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.min,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.min,s.uf)}),(0,a.jsx)(r.$,{name:"5%",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.p5,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.p5,s.uf)}),(0,a.jsx)(r.$,{name:"25%",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.p25,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.p25,s.uf)}),(0,a.jsx)(r.$,{name:"50%",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.p50,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.p50,s.uf)}),(0,a.jsx)(r.$,{name:"75%",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.p75,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.p75,s.uf)}),(0,a.jsx)(r.$,{name:"95%",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.p95,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.p95,s.uf)}),(0,a.jsx)(r.$,{name:"Max",firstSlot:(0,s.uy)(null===e||void 0===e?void 0:e.max,s.uf),secondSlot:d?c:o?void 0:(0,s.uy)(null===i||void 0===i?void 0:i.max,s.uf)})]})]})}},8453:function(n,e,i){i.d(e,{y:function(){return s}});var t=i(885),l=i(2791);function s(n){var e=(0,l.useState)(null),i=(0,t.Z)(e,2),s=i[0],r=i[1];return(0,l.useEffect)((function(){if(n&&n.current){var e=n.current,i=new ResizeObserver((function(n){n.forEach((function(n){r(n.contentRect)}))}));return i.observe(e),function(){i.unobserve(e)}}}),[n]),s}},9842:function(n,e,i){i.d(e,{v:function(){return u}});var t=i(5251),l="var(--chakra-space-2)",s="var(--chakra-space-2)",r="var(--chakra-space-4)",a="var(--chakra-space-4)",d="var(--chakra-radii-md)",o="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(n){var e=n.target,i=n.style,u=void 0===i?{}:i;return t.Ys(e).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||l).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||s).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||d).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||r).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||a).style("color",(null===u||void 0===u?void 0:u.color)||o).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}},922:function(n,e,i){i.d(e,{Fo:function(){return a},NN:function(){return r},WN:function(){return s},gQ:function(){return d}});var t=i(2982),l=i(885);function s(n,e){var i={};return Object.entries(n||{}).forEach((function(n){var e=(0,l.Z)(n,2),t=e[0],s=e[1];i[t]||(i[t]={}),i[t].base=s})),Object.entries(e||{}).forEach((function(n){var e=(0,l.Z)(n,2),t=e[0],s=e[1];i[t]||(i[t]={}),i[t].target=s})),i}function r(n){var e=n.base,i=n.target,l=new Map;if(!e||!i)return null;var s=e.labels.map((function(n,i){return l.set(n||String(i),i),{label:n,base:e.counts[i],target:0}}));return i.labels.reduce((function(n,e,s){var r=e||String(s),a=l.has(r),d=i.counts[s];if(a)return n[l.get(r)].target=d,n;var o={label:e,base:0,target:d};return[].concat((0,t.Z)(n),[o])}),s)}function a(n){var e=n.baseCounts,i=n.baseLabels;return e.map((function(n,e){return{label:i[e],base:n,target:0}}))}function d(n){var e=n.non_nulls,i=n.total,t=n.mismatched||0,l=e-t,s=i-e;return{hasNoNull:e===i,mismatch:t,valid:l,missing:s,distinctOfTotal:n.distinct/i,validOfTotal:l/i,mismatchOfTotal:t/i,missingOfTotal:s/i,totalOfTotal:i/i,total:i}}}}]);
//# sourceMappingURL=826.6840154c.chunk.js.map