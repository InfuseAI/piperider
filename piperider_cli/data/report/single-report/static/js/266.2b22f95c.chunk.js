"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[266],{6787:function(e,n,t){t.r(n),t.d(n,{default:function(){return q}});var i=t(1413),l=t(885),r=t(5223),a=t(8735),s=t(6837),o=t(4385),d=t(8625),c=t(2791),u=t(6744),v=t(6157),h=t(2483),x=t(6786),f=t(3442),j=t(5987),p=t(1564),m=t(2504),g=t(7005),y=t(2387),b=t(184);function T(e){switch(e.status){case"passed":return(0,b.jsx)(a.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,b.jsx)(a.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,b.jsx)(a.xv,{as:"span",role:"img",children:"-"})}}function C(e){var n,t,i,l,r,a,s=e.data;return(0,b.jsx)(g.xJ,{children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{}),(0,b.jsx)(g.Th,{children:"Status"}),(0,b.jsx)(g.Th,{children:"Message"})]})}),(0,b.jsxs)(g.p3,{children:[(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===s||void 0===s||null===(n=s.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(g.Td,{children:null!==(t=null===s||void 0===s||null===(i=s.base)||void 0===i?void 0:i.message)&&void 0!==t?t:y.Nj})]}),(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===s||void 0===s||null===(l=s.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(g.Td,{children:null!==(r=null===s||void 0===s||null===(a=s.base)||void 0===a?void 0:a.message)&&void 0!==r?r:y.Nj})]})]})]})})}var k=t(1971);function S(e){var n,t,i,l,r,a,s=e.data;return(0,b.jsx)(g.xJ,{children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{}),(0,b.jsx)(g.Th,{children:"Status"}),(0,b.jsx)(g.Th,{children:"Expected"}),(0,b.jsx)(g.Th,{children:"Actual"})]})}),(0,b.jsxs)(g.p3,{children:[(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===s||void 0===s||null===(n=s.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(g.Td,{children:(0,k.sG)(null===s||void 0===s||null===(t=s.base)||void 0===t?void 0:t.expected)}),(0,b.jsx)(g.Td,{children:(0,k.sG)(null===s||void 0===s||null===(i=s.base)||void 0===i?void 0:i.actual)})]}),(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===s||void 0===s||null===(l=s.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(g.Td,{children:(0,k.sG)(null===s||void 0===s||null===(r=s.target)||void 0===r?void 0:r.expected)}),(0,b.jsx)(g.Td,{children:(0,k.sG)(null===s||void 0===s||null===(a=s.target)||void 0===a?void 0:a.actual)})]})]})]})})}var N=["data","type","isOpen","onClose"];function _(e){var n=e.data,t=e.type,l=void 0===t?"piperider":t,r=e.isOpen,s=e.onClose,o=(0,j.Z)(e,N);return(0,b.jsxs)(p.u_,(0,i.Z)((0,i.Z)({},o),{},{isOpen:r,size:"2xl",onClose:function(){s()},children:[(0,b.jsx)(p.ZA,{}),(0,b.jsxs)(p.hz,{children:[(0,b.jsx)(p.xB,{children:(0,b.jsx)(a.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,b.jsx)(p.ol,{}),(0,b.jsx)(p.fe,{children:"piperider"===l?(0,b.jsx)(S,{data:n}):(0,b.jsx)(C,{data:n})}),(0,b.jsx)(p.mz,{children:(0,b.jsx)(m.zx,{onClick:s,children:"Close"})})]})]}))}var w=t(6523),Z=t(922),A=t(3597),O=t(8453),P=t(9227),E=t(9842),W=["base","target"];function I(e){var n=e.data,t=(0,c.useRef)(null),i=(0,c.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,c.useEffect)((function(){if(n&&i&&t){var e=P.Ys(n.current),l=t.map((function(e){return e.label||""})),r=P.tiA().domain(l).range([0,i.width]).padding(.2),a=P.tiA().domain(W).range([0,r.bandwidth()]).padding(.05),s=P.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:""}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(s);var o=P.BYU().domain([0,P.Fp7(t,(function(e){var n=e.base,t=e.target;return Math.max(n,t)}))]).range([i.height,0]),d=P.y4O(o);e.select(".y-axis").call(d);var c=P.PKp().domain(W).range(["var(--chakra-colors-blue-100)","var(--chakra-colors-blue-300)"]),u=e.selectAll(".grouped-chart").data(t).join("g").attr("class","grouped-chart").attr("transform",(function(e){return"translate(".concat(r(e.label),", 0)")})),v=(0,E.v)({target:".chart"});return u.selectAll("rect").data((function(e){return W.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).enter().append("rect").attr("x",(function(e){return a(e.key)})).attr("y",(function(e){return o(e.value)})).attr("width",(function(e){return a.bandwidth()})).attr("height",(function(e){return i.height-o(e.value)})).attr("fill",(function(e){return c(e.key)})),u.selectAll(".overlay-bars").data((function(e){return W.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).join("rect").attr("class","overlay-bars").attr("x",(function(e){return a(e.key)})).attr("y",(function(){return 0})).attr("width",a.bandwidth()).attr("height",(function(){return i.height})).attr("fill",(function(e){return c(e.key)})).style("opacity",0).on("mouseover",(function(e,n){v.html("\n        <div>\n          <p>Label: ".concat(n.label,"</p>\n          <p>Count: ").concat((0,k.uf)(n.value),"</p>\n        </div>\n      ")).transition().duration(500).style("visibility","visible"),P.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){v.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){v.html("").transition().duration(500).style("visibility","hidden"),P.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[t,i,n])}({target:t,data:n,dimensions:(0,O.y)(i)}),(0,b.jsx)(a.kC,{className:"chart",width:"100%",ref:i,children:(0,b.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,b.jsx)("g",{className:"x-axis"}),(0,b.jsx)("g",{className:"y-axis"})]})})}function R(e){var n=e.name,t=e.firstSlot,i=e.secondSlot,l=e.firstSlotWidth,r=void 0===l?"100px":l,s=e.secondSlotWidth,o=void 0===s?"100px":s;return(0,b.jsxs)(a.kC,{justifyContent:"space-between",children:[(0,b.jsx)(a.xv,{fontWeight:700,children:n}),(0,b.jsxs)(a.kC,{gap:{lg:5,md:1},children:[(0,b.jsx)(a.xv,{textAlign:"right",width:r,noOfLines:1,children:t}),i&&(0,b.jsx)(a.xv,{textAlign:"right",width:o,children:i})]})]})}function Y(e){var n=e.baseColumn,t=e.targetColumn;if(n){(0,w.h5)(w.a$.safeParse(n));var i=n.nulls,l=n.total,r=n.valids,a=n.invalids,s=(0,Z.gQ)(n),o=s.totalOfTotal,d=s.distinctOfTotal,c=s.invalidsOfTotal,u=s.validsOfTotal,v=s.nullsOfTotal}if(t){var h=t.total;w.a$.parse(t);var x=(0,Z.gQ)(t),f=x.invalidsOfTotal,j=x.distinctOfTotal,p=x.validsOfTotal,m=x.nullsOfTotal}var g=null===t;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(R,{name:"Total",firstSlot:(0,k.uy)(l,k.uf),secondSlot:g?y.Nj:(0,k.uy)(t?h:o,t?k.uf:k.Zn)}),(0,b.jsx)(R,{name:"Valid",firstSlot:(0,k.uy)(t?u:r,t?k.Zn:k.uf),secondSlot:g?y.Nj:(0,k.uy)(t?p:u,k.Zn)}),(0,b.jsx)(R,{name:"Invalid",firstSlot:(0,k.uy)(t?c:a,t?k.Zn:k.uf),secondSlot:g?y.Nj:(0,k.uy)(t?f:c,k.Zn)}),(0,b.jsx)(R,{name:"Missing",firstSlot:(0,k.uy)(t?v:i,t?k.Zn:k.uf),secondSlot:g?y.Nj:(0,k.uy)(t?m:v,k.Zn)}),(0,b.jsx)(R,{name:"Distinct",firstSlot:(0,k.uy)(d,k.Zn),secondSlot:g?y.Nj:(0,k.uy)(t?j:d,k.Zn)})]})}function z(e){var n=e.baseColumn,t=e.targetColumn,i=null===t,l=void 0===t;return(0,w.h5)(w.a$.safeParse(n)),(0,w.h5)(w.a$.safeParse(n)),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(a.kC,{direction:"column",children:[(0,b.jsx)(R,{name:"Average",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.avg,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.avg,k.uf)}),(0,b.jsx)(R,{name:"Std. Deviation",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.stddev,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.stddev,k.uf)})]}),(0,b.jsxs)(a.kC,{direction:"column",children:[(0,b.jsx)(R,{name:"Min",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.min,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.min,k.uf)}),(0,b.jsx)(R,{name:"5%",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.p5,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.p5,k.uf)}),(0,b.jsx)(R,{name:"25%",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.p25,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.p25,k.uf)}),(0,b.jsx)(R,{name:"50%",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.p50,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.p50,k.uf)}),(0,b.jsx)(R,{name:"75%",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.p75,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.p75,k.uf)}),(0,b.jsx)(R,{name:"95%",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.p95,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.p95,k.uf)}),(0,b.jsx)(R,{name:"Max",firstSlot:(0,k.uy)(null===n||void 0===n?void 0:n.max,k.uf),secondSlot:i?y.Nj:l?void 0:(0,k.uy)(null===t||void 0===t?void 0:t.max,k.uf)})]})]})}var L=function(e){var n,t,i,l,r=e.baseColumn,s=e.targetColumn,o=r||s;return(0,w.h5)(w.a$.safeParse(r)),(0,w.h5)(w.a$.safeParse(s)),(0,b.jsx)(a.kC,{direction:"column",gap:2,minH:"250px",children:(0,b.jsxs)(a.kC,{direction:"column",gap:3,children:[(0,b.jsxs)(a.kC,{justifyContent:"space-between",children:[(0,b.jsxs)(a.xv,{maxWidth:"calc(100% - 250px)",children:[(0,b.jsx)(a.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,noOfLines:1,title:null===o||void 0===o?void 0:o.name,children:null===o||void 0===o?void 0:o.name}),"","(",(0,b.jsx)(a.EK,{children:null===o||void 0===o?void 0:o.schema_type}),")"]}),(0,b.jsxs)(a.kC,{gap:8,children:[(0,b.jsx)(a.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,b.jsx)(a.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]})]}),(0,b.jsx)(a.kC,{direction:"column",mt:3,children:(0,b.jsx)(Y,{baseColumn:r,targetColumn:s||null})}),"numeric"===(null===r||void 0===r?void 0:r.type)&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(z,{baseColumn:r,targetColumn:s||null})}),"datetime"===(null===r||void 0===r?void 0:r.type)&&(0,b.jsxs)(a.kC,{direction:"column",children:[(0,b.jsx)(R,{name:"Min",firstSlot:null!==(n=null===r||void 0===r?void 0:r.min)&&void 0!==n?n:y.Nj,secondSlot:null!==(t=null===s||void 0===s?void 0:s.min)&&void 0!==t?t:y.Nj}),(0,b.jsx)(R,{name:"Max",firstSlot:null!==(i=null===r||void 0===r?void 0:r.max)&&void 0!==i?i:y.Nj,secondSlot:null!==(l=null===s||void 0===s?void 0:s.max)&&void 0!==l?l:y.Nj})]})]})})};function F(e){var n=e.baseTable,t=e.targetTable;(0,w.h5)(w.vT.safeParse(n)),(0,w.h5)(w.vT.safeParse(t));var i=(0,Z.WN)(null===n||void 0===n?void 0:n.columns,null===t||void 0===t?void 0:t.columns);return(0,b.jsx)(b.Fragment,{children:Object.entries(i).map((function(e){var n=(0,l.Z)(e,2),t=n[0],i=n[1];return(0,b.jsx)(G,{name:t,base:null===i||void 0===i?void 0:i.base,target:null===i||void 0===i?void 0:i.target},t)}))})}function G(e){var n=e.name,t=e.base,i=e.target,r=(0,c.useState)(null),s=(0,l.Z)(r,2),o=s[0],d=s[1],u=(0,c.useState)([]),v=(0,l.Z)(u,2),h=v[0],x=v[1];return(0,c.useEffect)((function(){var e=(null===t||void 0===t?void 0:t.type)===(null===i||void 0===i?void 0:i.type),n="string"===(null===t||void 0===t?void 0:t.type)||"datetime"===(null===t||void 0===t?void 0:t.type);if(e&&n){var l=(0,Z.G_)({base:null===t||void 0===t?void 0:t.histogram,target:null===i||void 0===i?void 0:i.histogram});d(l)}else{var r=(0,Z.cc)(t),a=(0,Z.cc)(i);x([r,a])}}),[t,i]),(0,b.jsx)(a.kC,{direction:"column",children:(0,b.jsxs)(a.rj,{my:8,templateColumns:"500px 1fr",gap:12,children:[(0,b.jsx)(L,{baseColumn:t,targetColumn:i}),(0,b.jsxs)(a.rj,{my:4,templateColumns:"1fr ".concat(o?"":"1fr"),gap:o?0:12,overflowX:"hidden",children:[o?(0,b.jsx)(I,{data:o}):o?(0,b.jsx)(D,{}):null,h[0]?(0,b.jsx)(A.f,{data:h[0]}):o?null:(0,b.jsx)(D,{}),h[1]?(0,b.jsx)(A.f,{data:h[1]}):o?null:(0,b.jsx)(D,{})]})]})},n)}function D(){return(0,b.jsx)(a.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var V=t(2982),M=t(5984),B=function(e,n){return e?Object.entries(e).map((function(e){var t=(0,l.Z)(e,2),r=t[0],a=t[1];return(0,i.Z)((0,i.Z)({},a),{},{key:r,type:n,changed:!1})})):[]};function J(e){var n=e.base,t=e.target;(0,w.h5)(w.vT.safeParse(n)),(0,w.h5)(w.vT.safeParse(t));var l=B(null===n||void 0===n?void 0:n.columns,"base"),r=B(null===t||void 0===t?void 0:t.columns,"target"),s=[].concat((0,V.Z)(l),(0,V.Z)(r)),o=r.length-l.length,d=o<0?0:o,c=l.length-r.length,u=c<0?0:c,v=s.reduce((function(e,n,t){var r,a,o=t<l.length?t:t-l.length,d=t>=l.length?t:t+l.length,c=(null===(r=s[o])||void 0===r?void 0:r.schema_type)!==(null===(a=s[d])||void 0===a?void 0:a.schema_type),u=e.changed+(c?1:0),v=(0,i.Z)((0,i.Z)({},n),{},{name:n.name,changed:c});return(0,i.Z)((0,i.Z)({},e),{},{changed:u,columns:[].concat((0,V.Z)(e.columns),[v])})}),{added:d,deleted:u,changed:0,columns:[]}),h=v.added,x=v.deleted,f=v.changed,j=v.columns,p=j.slice(0,l.length),m=j.slice(l.length),T=K(p,m,o),C=K(m,p,c);return(0,b.jsxs)(a.kC,{direction:"column",children:[(0,b.jsxs)(a.xv,{mb:4,p:2,children:["Added:",(0,b.jsx)(a.xv,{as:"span",fontWeight:700,ml:1,children:h}),", Deleted:",(0,b.jsx)(a.xv,{as:"span",fontWeight:700,ml:1,children:x}),", Changed:"," ",(0,b.jsx)(a.xv,{as:"span",fontWeight:700,ml:1,children:f})]}),(0,b.jsxs)(a.kC,{justifyContent:"space-evenly",children:[(0,b.jsx)(g.xJ,{width:"50%",children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{children:"Column"}),(0,b.jsx)(g.Th,{children:"Type"})]})}),(0,b.jsx)(g.p3,{children:T.map((function(e){var n,t;return(0,b.jsxs)(g.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,b.jsx)(g.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:y.Nj}),(0,b.jsx)(g.Td,{children:null!==(t=null===e||void 0===e?void 0:e.schema_type)&&void 0!==t?t:y.Nj})]},(0,M.x0)(10))}))})]})}),(0,b.jsx)(a.kC,{justifyContent:"center",children:(0,b.jsx)(a.iz,{orientation:"vertical"})}),(0,b.jsx)(g.xJ,{width:"50%",children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{children:"Column"}),(0,b.jsx)(g.Th,{children:"Type"})]})}),(0,b.jsx)(g.p3,{children:C.map((function(e){var n,t;return(0,b.jsxs)(g.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,b.jsx)(g.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:y.Nj}),(0,b.jsx)(g.Td,{children:null!==(t=null===e||void 0===e?void 0:e.schema_type)&&void 0!==t?t:y.Nj})]},(0,M.x0)(10))}))})]})})]})]})}function K(e,n,t){return e.length<n.length?[].concat((0,V.Z)(e),(0,V.Z)(Array(t).fill(null))):e}var $=t(8444),H=t.n($),Q=["base","target"];function U(e){var n=e.base,t=void 0===n?[]:n,i=e.target,l=void 0===i?[]:i,r=(0,j.Z)(e,Q),s=H()([].concat((0,V.Z)(t),(0,V.Z)(l)),(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),o=Object.values(s).map((function(e){var n={level:e[0].level,column:e[0].column,name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}));return 0===o.length?(0,b.jsx)(a.kC,{direction:"column",children:(0,b.jsx)(a.xv,{textAlign:"center",children:"No tests available"})}):(0,b.jsx)(g.xJ,{children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{children:"Level"}),(0,b.jsx)(g.Th,{children:"Column"}),(0,b.jsx)(g.Th,{children:"Assertion"}),(0,b.jsx)(g.Th,{children:"Base Status"}),(0,b.jsx)(g.Th,{children:"Target Status"}),(0,b.jsx)(g.Th,{})]})}),(0,b.jsx)(g.p3,{children:Object.values(o).map((function(e){var n,t;return(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{children:e.level}),(0,b.jsx)(g.Td,{children:e.column}),(0,b.jsx)(g.Td,{children:e.name}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(g.Td,{children:(0,b.jsx)(T,{status:null===(t=e.target)||void 0===t?void 0:t.status})}),(0,b.jsx)(g.Td,{onClick:function(){r.onDetailVisible(e)},children:(0,b.jsx)(a.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,M.x0)())}))})]})})}function X(e){var n,t,i,l,r,s,o=e.baseTable,d=e.targetTable;(0,w.h5)(w.vT.safeParse(o)),(0,w.h5)(w.vT.safeParse(d));var c=(0,v.YI)(null===o||void 0===o?void 0:o.piperider_assertion_result,null===o||void 0===o?void 0:o.dbt_assertion_result),u=(0,v.YI)(null===d||void 0===d?void 0:d.piperider_assertion_result,null===d||void 0===d?void 0:d.dbt_assertion_result);return(0,b.jsxs)(a.kC,{gap:4,direction:"column",children:[(0,b.jsx)(a.X6,{fontSize:24,children:"Overview"}),(0,b.jsx)(g.xJ,{children:(0,b.jsxs)(g.iA,{variant:"simple",children:[(0,b.jsx)(g.hr,{children:(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Th,{width:"10%"}),(0,b.jsx)(g.Th,{width:"45%",children:"Base"}),(0,b.jsx)(g.Th,{width:"45%",children:"Target"})]})}),(0,b.jsxs)(g.p3,{children:[(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{children:"Table"}),(0,b.jsx)(g.Td,{children:null!==(n=null===o||void 0===o?void 0:o.name)&&void 0!==n?n:y.Nj}),(0,b.jsx)(g.Td,{children:null!==(t=null===d||void 0===d?void 0:d.name)&&void 0!==t?t:y.Nj})]}),(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{children:"Rows"}),(0,b.jsx)(g.Td,{children:null!==(i=null===o||void 0===o?void 0:o.row_count)&&void 0!==i?i:y.Nj}),(0,b.jsx)(g.Td,{children:null!==(l=null===d||void 0===d?void 0:d.row_count)&&void 0!==l?l:y.Nj})]}),(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{children:"Columns"}),(0,b.jsx)(g.Td,{children:null!==(r=null===o||void 0===o?void 0:o.col_count)&&void 0!==r?r:y.Nj}),(0,b.jsx)(g.Td,{children:null!==(s=null===d||void 0===d?void 0:d.col_count)&&void 0!==s?s:y.Nj})]}),(0,b.jsxs)(g.Tr,{children:[(0,b.jsx)(g.Td,{children:"Test status"}),(0,b.jsx)(g.Td,{children:(0,b.jsxs)(a.xv,{children:[(0,b.jsxs)(a.xv,{as:"span",fontWeight:700,children:[c.passed," "]}),"Passed",", ",(0,b.jsxs)(a.xv,{as:"span",fontWeight:700,color:c.failed>0?"red.500":"inherit",children:[c.failed," "]}),"Failed"]})}),(0,b.jsx)(g.Td,{children:(0,b.jsxs)(a.xv,{children:[(0,b.jsxs)(a.xv,{as:"span",fontWeight:700,children:[u.passed," "]}),"Passed",", ",(0,b.jsxs)(a.xv,{as:"span",fontWeight:700,color:u.failed>0?"red.500":"inherit",children:[u.failed," "]}),"Failed"]})})]})]})]})})]})}function q(e){var n,t=e.data,j=e.name,p=(0,c.useState)(null),m=(0,l.Z)(p,2),g=m[0],y=m[1],T=(0,r.qY)(),C=t.base,k=t.input;(0,w.h5)((0,w.C6)(!0).safeParse(t));var S=C.tables[j],N=k.tables[j],Z=null===(n=C.tables[j])||void 0===n?void 0:n.dbt_assertion_result;(0,w.h5)(w.vT.safeParse(S)),(0,w.h5)(w.vT.safeParse(N));var A=(0,v.Ix)({data:t,reportName:j,type:"piperider"}),O=(0,l.Z)(A,2),P=O[0],E=O[1],W=(0,v.Ix)({data:t,reportName:j,type:"dbt"}),I=(0,l.Z)(W,2),R=I[0],Y=I[1];return(0,h.j)(j),(0,x.L)({eventName:f.m.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Schema"}}),(0,b.jsxs)(u.o,{children:[(0,b.jsxs)(a.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,b.jsx)(a.kC,{mx:"5%",mt:4,children:(0,b.jsxs)(s.aG,{fontSize:"lg",children:[(0,b.jsx)(s.gN,{children:(0,b.jsx)(d.rU,{href:"/",children:(0,b.jsx)(s.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:"Tables"})})}),(0,b.jsx)(s.gN,{isCurrentPage:!0,children:(0,b.jsx)(s.At,{href:"#",children:j})})]})}),(0,b.jsxs)(a.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",children:[(0,b.jsx)(X,{baseTable:S,targetTable:N}),(0,b.jsxs)(o.mQ,{isLazy:!0,children:[(0,b.jsxs)(o.td,{children:[(0,b.jsx)(o.OK,{onClick:function(){(0,f._)({eventName:f.m.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Schema"}})},children:"Schema"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-profiling",onClick:function(){(0,f._)({eventName:f.m.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Profiling"}})},children:"Profiling"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-tests",onClick:function(){(0,f._)({eventName:f.m.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Tests"}})},children:"Tests"}),Z&&(0,b.jsx)(o.OK,{onClick:function(){(0,f._)({eventName:f.m.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"dbt Tests"}})},children:"dbt Tests"})]}),(0,b.jsxs)(o.nP,{children:[(0,b.jsx)(o.x4,{children:(0,b.jsx)(J,{base:S,target:N})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)(F,{baseTable:S,targetTable:N})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)(U,{base:null===P||void 0===P?void 0:P.tests,target:null===E||void 0===E?void 0:E.tests,onDetailVisible:function(e){y({type:"piperider",data:e}),T.onOpen()}})}),(0,b.jsx)(o.x4,{children:0===(null===R||void 0===R?void 0:R.tests.length)&&0===(null===Y||void 0===Y?void 0:Y.tests.length)?(0,b.jsx)(a.kC,{justifyContent:"center",alignItems:"center",height:"100px",children:(0,b.jsx)(a.xv,{color:"gray.500",children:"No dbt tests available."})}):(0,b.jsx)(U,{base:null===R||void 0===R?void 0:R.tests,target:null===Y||void 0===Y?void 0:Y.tests,onDetailVisible:function(e){y({type:"dbt",data:e}),T.onOpen()}})})]})]})]})]}),(0,b.jsx)(_,(0,i.Z)((0,i.Z)({},T),{},{type:null===g||void 0===g?void 0:g.type,data:null===g||void 0===g?void 0:g.data,onClose:function(){T.onClose(),y(null)}}))]})}},3597:function(e,n,t){t.d(n,{f:function(){return c}});var i=t(8735),l=t(2791),r=t(8453),a=t(9227),s=t(1971),o=t(9842);var d=t(184);function c(e){var n=e.data,t=(0,l.useRef)(null),c=(0,l.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,l.useEffect)((function(){if(n&&i&&t){var e=a.Ys(n.current),l=a.tiA().domain(t.map((function(e){return String(e.label)}))).range([0,i.width]).padding(.05),r=a.LLu(l).tickFormat((function(e,n){var t=l.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(r);var d=a.BYU().domain([0,a.Fp7(t,(function(e){return e.value}))]).range([i.height,0]),c=a.y4O(d);e.select(".y-axis").call(c),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return l(e.label)})).attr("y",(function(e){return d(e.value)})).attr("width",l.bandwidth()).attr("height",(function(e){return i.height-d(e.value)})).style("fill","var(--chakra-colors-blue-300)");var u=(0,o.v)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return l(String(e.label))})).attr("y",(function(){return 0})).attr("width",l.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n.label,i=n.value,l=n.total,r=(0,o.p)(n);u.html("\n          <div>\n            <p>".concat(r,": ").concat(t,"</p>\n            <p>Count: ").concat((0,s.uf)(i),"</p>\n            <p>Percentage: ").concat(Number(i/l*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),a.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){u.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){u.html("").transition().duration(500).style("visibility","hidden"),a.Ys(this).style("opacity",0)})),function(){e.select("svg").remove(),e.selectAll(".chart_tooltip").remove()}}}),[n,i,t])}({target:t,data:n,dimensions:(0,r.y)(c)}),(0,d.jsx)(i.kC,{className:"chart",width:"100%",minHeight:230,ref:c,children:(0,d.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,d.jsx)("g",{className:"x-axis"}),(0,d.jsx)("g",{className:"y-axis"})]})})}},6786:function(e,n,t){t.d(n,{L:function(){return a}});var i=t(1413),l=t(2791),r=t(3442);function a(e){(0,l.useEffect)((function(){(0,r._)((0,i.Z)({},e))}),[])}},8453:function(e,n,t){t.d(n,{y:function(){return r}});var i=t(885),l=t(2791);function r(e){var n=(0,l.useState)(null),t=(0,i.Z)(n,2),r=t[0],a=t[1];return(0,l.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){a(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),r}},3442:function(e,n,t){t.d(n,{_:function(){return a},m:function(){return r}});var i=t(1413),l=t(8083),r={PAGE_VIEW:"Page View"};function a(e){var n=e.eventName,t=e.eventProperties,r=e.eventOptions,a=window.PIPERIDER_METADATA.amplitude_api_key,s=window.PIPERIDER_METADATA.amplitude_project_id;return a?(0,l.j)(n,(0,i.Z)({project_id:s},t),r):console.info(n,(0,i.Z)({project_id:s},t),r)}},9842:function(e,n,t){t.d(n,{p:function(){return h},v:function(){return v}});var i=t(9227),l=t(2387),r="var(--chakra-space-2)",a="var(--chakra-space-2)",s="var(--chakra-space-4)",o="var(--chakra-space-4)",d="var(--chakra-radii-md)",c="var(--chakra-colors-white)",u="var(--chakra-colors-blackAlpha-700)";function v(e){var n=e.target,t=e.style,l=void 0===t?{}:t;return i.Ys(n).append("div").attr("class","chart_tooltip").style("visibility","hidden").style("position","absolute").style("z-index","1501").style("padding-top",(null===l||void 0===l?void 0:l.paddingTop)||r).style("padding-bottom",(null===l||void 0===l?void 0:l.paddingBottom)||a).style("border-radius",(null===l||void 0===l?void 0:l.borderRadius)||d).style("padding-left",(null===l||void 0===l?void 0:l.paddingLeft)||s).style("padding-right",(null===l||void 0===l?void 0:l.paddingRight)||o).style("color",(null===l||void 0===l?void 0:l.color)||c).style("background-color",(null===l||void 0===l?void 0:l.backgroundColor)||u)}function h(e){var n=e.type;return e.isCategorical?l.bF:"string"===n?l.d4:"boolean"===n?l.RW:"datetime"===n?l.qI:l.E5}},922:function(e,n,t){t.d(n,{G_:function(){return a},JH:function(){return o},WN:function(){return r},cc:function(){return d},gQ:function(){return s}});var i=t(2982),l=t(885);function r(e,n){var t={};return Object.entries(e||{}).forEach((function(e){var n=(0,l.Z)(e,2),i=n[0],r=n[1];t[i]||(t[i]={}),t[i].base=r})),Object.entries(n||{}).forEach((function(e){var n=(0,l.Z)(e,2),i=n[0],r=n[1];t[i]||(t[i]={}),t[i].target=r})),t}function a(e){var n=e.base,t=e.target,l=new Map;if(!n||!t)return null;var r=n.labels.map((function(e,t){return l.set(e||String(t),t),{label:e,base:n.counts[t],target:0}}));return t.labels.reduce((function(e,n,r){var a=n||String(r),s=l.has(a),o=t.counts[r];if(s)return e[l.get(a)].target=o,e;var d={label:n,base:0,target:o};return[].concat((0,i.Z)(e),[d])}),r)}function s(e){var n=e.nulls,t=e.non_nulls,i=e.total,l=e.invalids,r=e.distinct,a=e.valids,s=e.non_duplicates,o=e.duplicates,d=e.zero_length,c=e.negatives,u=e.zeros;return{negativesOfTotal:c&&i?c/i:null,zerosOfTotal:u&&i?u/i:null,hasNoNull:t===i,zeroLengthOfTotal:d&&i?d/i:null,distinctOfTotal:r&&i?r/i:null,validsOfTotal:a&&i?a/i:null,invalidsOfTotal:l&&i?l/i:null,nullsOfTotal:n&&i?n/i:null,duplicatesOfTotal:o&&i?o/i:null,nonDuplicatesOfTotal:s&&i?s/i:null,totalOfTotal:i?i/i:null}}function o(e){var n=e.distinct,t=e.type;return"number"===typeof n&&(n<=100&&("string"===t||"integer"===t))}function d(e){if(e){var n=e.topk,t=e.histogram,i=e.trues,l=e.falses,r=e.type,a=e.total,s=o(e),d="boolean"===r,c=s?null===n||void 0===n?void 0:n.values:d?["TRUES","FALSES"]:null===t||void 0===t?void 0:t.labels,u=s?null===n||void 0===n?void 0:n.counts:d?[i,l]:null===t||void 0===t?void 0:t.counts;return c&&u&&a?c.map((function(e,n){return{label:e,isCategorical:s,value:u[n],type:r,total:a}})):void 0}}}}]);
//# sourceMappingURL=266.2b22f95c.chunk.js.map