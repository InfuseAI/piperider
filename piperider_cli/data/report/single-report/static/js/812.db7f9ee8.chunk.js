"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[812],{6812:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var r=t(8470),i=t(3929),s=t(3793),a=t(1659),l=t(3609),c=t(964),d=t(560),o=t(8243),h=t(4947),x=t(3558);var u=t(9953),j=t(4197);function m(e){var n=e.source,t=e.data,a=e.reportName;if((0,u.j)(a),!t)return(0,j.jsx)(d.o,{children:(0,j.jsx)(r.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})});var l=(0,h.c6)(null===t||void 0===t?void 0:t.assertion_results);return(0,j.jsx)(d.o,{alignItems:"flex-start",children:(0,j.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,j.jsx)(r.kC,{mx:"10%",mt:4,children:(0,j.jsxs)(i.aG,{fontSize:"lg",children:[(0,j.jsx)(i.gN,{children:(0,j.jsx)(c.rU,{href:"/",children:(0,j.jsx)(i.At,{href:"/",children:n.name})})}),(0,j.jsx)(i.gN,{isCurrentPage:!0,children:(0,j.jsx)(i.At,{href:"#",children:t.name})})]})}),(0,j.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,j.jsxs)(r.kC,{direction:"column",gap:4,mb:8,children:[(0,j.jsx)(r.X6,{size:"lg",children:"Overview"}),(0,j.jsxs)(r.xv,{children:["Table:"," ",(0,j.jsx)(r.xv,{as:"span",fontWeight:700,children:t.name})]}),(0,j.jsxs)(r.xv,{children:["Rows:"," ",(0,j.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,h.uf)(t.row_count)})]}),(0,j.jsxs)(r.xv,{children:["Columns:"," ",(0,j.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,h.uf)(t.col_count)})]}),(0,j.jsxs)(r.xv,{children:["Test Status:"," ",(0,j.jsx)(r.xv,{as:"span",fontWeight:700,children:l.passed})," ","Passed,"," ",(0,j.jsx)(r.xv,{as:"span",fontWeight:700,color:l.failed>0?"red.500":"inherit",children:l.failed})," ","Failed"]})]}),(0,j.jsxs)(s.mQ,{isLazy:!0,children:[(0,j.jsxs)(s.td,{children:[(0,j.jsx)(s.OK,{children:"Profiling"}),(0,j.jsx)(s.OK,{children:"Tests"})]}),(0,j.jsxs)(s.nP,{children:[(0,j.jsx)(s.x4,{children:(0,j.jsx)(p,{data:t.columns})}),(0,j.jsx)(s.x4,{children:(0,j.jsx)(f,{tableName:t.name,data:t.assertion_results})})]})]})]})]})})}function p(e){var n=e.data;return(0,j.jsx)(r.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e],i=t.distribution,s=t.non_nulls===t.total;return(0,j.jsxs)(r.kC,{direction:"column",px:4,children:[(0,j.jsxs)(r.rj,{my:4,templateColumns:"450px 1fr",gap:4,children:[(0,j.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,j.jsxs)(r.xv,{children:[(0,j.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,children:t.name}),"","(",(0,j.jsx)(r.EK,{children:t.schema_type}),")"]}),(0,j.jsxs)(r.kC,{direction:"column",children:[(0,j.jsx)(o.$,{name:"Total",base:(0,h.uf)(t.total)}),(0,j.jsx)(o.$,{name:"Missing",base:(0,j.jsx)(r.xv,{as:"span",color:s?"green.500":"red.500",children:s?"0%":(0,h.ro)(t)})}),(0,j.jsx)(o.$,{name:"Distinct",base:(0,h.uf)(t.distinct)})]}),"numeric"===t.type&&(0,j.jsxs)(r.kC,{direction:"column",children:[(0,j.jsx)(o.$,{name:"Min",base:(0,h.uf)(t.min)}),(0,j.jsx)(o.$,{name:"Max",base:(0,h.uf)(t.max)}),(0,j.jsx)(o.$,{name:"Avg",base:(0,h.uf)(t.avg)})]}),"datetime"===t.type&&(0,j.jsxs)(r.kC,{direction:"column",children:[(0,j.jsx)(o.$,{name:"Min",base:t.min}),(0,j.jsx)(o.$,{name:"Max",base:t.max})]})]}),(0,j.jsx)(r.kC,{mt:8,justifyContent:"center",alignItems:"center",children:i?(0,j.jsx)(v,{data:i.labels.map((function(e,n){return{label:e,value:i.counts[n],total:t.total}}))}):(0,j.jsx)(r.xv,{children:"No data available"})})]}),(0,j.jsx)(r.iz,{my:4})]},e)}))})}function f(e){e.tableName;var n=e.data,t=null===n||void 0===n?void 0:n.tests,i=null===n||void 0===n?void 0:n.columns;return 0===t.length&&0===Object.keys(i).length?(0,j.jsx)(r.kC,{direction:"column",children:(0,j.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,j.jsx)(r.kC,{direction:"column",gap:4,children:(0,j.jsx)(a.xJ,{children:(0,j.jsxs)(a.iA,{variant:"simple",children:[(0,j.jsx)(a.hr,{children:(0,j.jsxs)(a.Tr,{children:[(0,j.jsx)(a.Th,{children:"Level"}),(0,j.jsx)(a.Th,{children:"Column"}),(0,j.jsx)(a.Th,{children:"Status"}),(0,j.jsx)(a.Th,{children:"Assertion"}),(0,j.jsx)(a.Th,{children:"Expected"}),(0,j.jsx)(a.Th,{children:"Actual"})]})}),(0,j.jsxs)(a.p3,{children:[t.map((function(e){var n="failed"===e.status;return(0,j.jsxs)(a.Tr,{children:[(0,j.jsx)(a.Td,{children:"Table"}),(0,j.jsx)(a.Td,{children:"-"}),(0,j.jsx)(a.Td,{children:n?(0,j.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,j.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,j.jsx)(a.Td,{children:e.name}),(0,j.jsx)(a.Td,{children:(0,h.aH)(e.expected)}),(0,j.jsx)(a.Td,{color:n&&"red.500",children:(0,h.aH)(e.actual)})]},e.name)})),Object.keys(i).map((function(e){return i[e].map((function(n){var t="failed"===n.status;return(0,j.jsxs)(a.Tr,{children:[(0,j.jsx)(a.Td,{children:"Column"}),(0,j.jsx)(a.Td,{children:e}),(0,j.jsx)(a.Td,{children:t?(0,j.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,j.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,j.jsx)(a.Td,{children:n.name}),(0,j.jsx)(a.Td,{children:(0,h.aH)(n.expected)}),(0,j.jsx)(a.Td,{color:t&&"red.500",children:(0,h.aH)(n.actual)})]},n.name)}))}))]})]})})})}function v(e){var n=e.data,t=(0,l.useRef)(null),i=(0,l.useRef)(null);return(0,l.useEffect)((function(){n.length>0&&function(e){var n=e.containerWidth,t=e.containerHeight,r=e.svgTarget,i=e.tooltipTarget,s=e.data,a=10,l=30,c=30,d=50,o=n-d-l,u=t-a-c,j=x.Ys(r);j.selectAll("*").remove();var m=j.attr("width",o+d+l).attr("height",u+a+c).append("g").attr("transform","translate(".concat(d,",").concat(a,")")),p=(0,h.vy)({target:i}),f=x.tiA().domain(s.map((function(e){return e.label}))).range([0,o]).padding(.5);m.append("g").attr("transform","translate(0, ".concat(u,")")).call(x.LLu(f).tickFormat((function(e,n){var t=f.domain().length-1;return 0===n||n===t/2||n===t?e:null})));var v=x.BYU().domain([0,x.Fp7(s,(function(e){return e.value}))]).range([u,0]);m.append("g").call(x.y4O(v).tickFormat((function(e){return"".concat(e)})).ticks(8)),m.selectAll().data(s).enter().append("rect").attr("x",(function(e){return f(e.label)})).attr("y",(function(e){return v(e.value)})).attr("height",(function(e){return u-v(e.value)})).attr("width",f.bandwidth()).style("fill","var(--chakra-colors-blue-300)").on("mouseover",(function(e,n){p.html("\n          <div>\n            <p>Label: ".concat(n.label,"</p>\n            <p>Count: ").concat((0,h.uf)(n.value),"</p>\n            <p>Percentage: ").concat(Number(n.value/n.total*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),x.Ys(this).style("fill","var(--chakra-colors-blue-100)")})).on("mousemove",(function(e){p.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){p.html("").transition().duration(500).style("visibility","hidden"),x.Ys(this).style("fill","var(--chakra-colors-blue-300)")}))}({containerWidth:i.current.getBoundingClientRect().width,containerHeight:i.current.getBoundingClientRect().height,svgTarget:t.current,tooltipTarget:".chart",data:n})}),[n]),(0,j.jsx)(r.kC,{className:"chart",width:"100%",ref:i,children:(0,j.jsx)("svg",{ref:t})})}},8243:function(e,n,t){t.d(n,{$:function(){return s}});var r=t(8470),i=t(4197);function s(e){var n=e.name,t=e.base,s=e.input;return(0,i.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,i.jsx)(r.xv,{fontWeight:700,children:n}),(0,i.jsxs)(r.kC,{gap:8,children:[(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:t}),s&&(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:s})]})]})}}}]);