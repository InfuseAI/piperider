"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(n,t,e){e.r(t),e.d(t,{default:function(){return P}});var i=e(8735),r=e(6837),s=e(4385),a=e(8625),l=e(3765),o=e(2483),d=e(2791),c=e(8453),u=e(5251),v=e(1971),h=e(9842);var f=e(184);function x(n){var t=n.data,e=(0,d.useRef)(null),r=(0,d.useRef)(null);return function(n){var t=n.target,e=n.data,i=n.dimensions;(0,d.useEffect)((function(){if(t&&i&&e){var n=u.Ys(t.current),r=u.tiA().domain(e.map((function(n){return n.label}))).range([0,i.width]).padding(.05),s=u.LLu(r).tickFormat((function(n,t){var e=r.domain().length-1;return 0===t||t===e/2||t===e?n:null}));n.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(s);var a=u.BYU().domain([0,u.Fp7(e,(function(n){return n.value}))]).range([i.height,0]),l=u.y4O(a);n.select(".y-axis").call(l),n.selectAll(".bar").data(e).join("rect").attr("class","bar").attr("x",(function(n){return r(n.label)})).attr("y",(function(n){return a(n.value)})).attr("width",r.bandwidth()).attr("height",(function(n){return i.height-a(n.value)})).style("fill","var(--chakra-colors-blue-300)");var o=(0,h.v)({target:".chart"});return n.selectAll(".overlay-bars").data(e).join("rect").attr("class","overlay-bars").attr("x",(function(n){return r(n.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(n,t){var e=t,i=e.label,r=e.value,s=e.total;o.html("\n          <div>\n            <p>Label: ".concat(i,"</p>\n            <p>Count: ").concat((0,v.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),u.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(n){o.style("top","".concat(n.pageY-10,"px")).style("left","".concat(n.pageX+10,"px"))})).on("mouseout",(function(){o.html("").transition().duration(500).style("visibility","hidden"),u.Ys(this).style("opacity",0)})),function(){n.select("svg").remove()}}}),[t,i,e])}({target:e,data:t,dimensions:(0,c.y)(r)}),(0,f.jsx)(i.kC,{className:"chart",width:"100%",ref:r,children:(0,f.jsxs)("svg",{width:"100%",overflow:"visible",ref:e,children:[(0,f.jsx)("g",{className:"x-axis"}),(0,f.jsx)("g",{className:"y-axis"})]})})}var m=e(511),j=e(5272),p=e(8662),g=e(709),y=e(8853),b=e(6523),S=function(n){var t=n.column;return(0,b.h5)(b.a$.safeParse(t)),(0,f.jsxs)(i.kC,{direction:"column",gap:3,children:[(0,f.jsxs)(i.xu,{maxWidth:"100%",children:[(0,f.jsxs)(i.kC,{children:[(0,f.jsx)(i.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:t.name,noOfLines:1,children:t.name}),(0,f.jsx)(y.l,{label:t.description,prefix:" - via ",placement:"right-end",children:(0,f.jsx)(j.hQ,{m:"auto 0"})})]}),"","(",(0,f.jsx)(i.EK,{children:t.schema_type}),")"]}),(0,f.jsx)(i.kC,{direction:"column",mt:3,children:(0,f.jsx)(g.H,{baseColumn:t})}),"string"===t.type&&t.distribution&&(0,f.jsx)(i.kC,{direction:"column",children:(0,f.jsx)(m.$,{name:"Most common",firstSlot:(0,v.qW)(t),firstSlotWidth:"200px"})}),"numeric"===t.type&&(0,f.jsx)(p.D,{baseColumn:t}),"datetime"===t.type&&(0,f.jsxs)(i.kC,{direction:"column",children:[(0,f.jsx)(m.$,{name:"Min",firstSlot:t.min}),(0,f.jsx)(m.$,{name:"Max",firstSlot:t.max})]})]})};function T(n){var t=n.data;return(0,f.jsx)(i.kC,{direction:"column",gap:4,children:Object.keys(t).map((function(n){var e=t[n];(0,b.h5)(b.a$.safeParse(e));var r=e.distribution;return(0,f.jsxs)(i.kC,{direction:"column",px:4,children:[(0,f.jsxs)(i.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,f.jsx)(S,{column:e}),(0,f.jsx)(i.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,f.jsx)(x,{data:r.labels.map((function(n,t){return{label:n,value:r.counts[t],total:e.total}}))}):(0,f.jsx)(i.xv,{children:"No data available"})})]}),(0,f.jsx)(i.iz,{my:4})]},n)}))})}var k=e(7005),C=e(4821),O=e(9201);function $(n){var t=n.assertionData,e=n.type,r=void 0===e?"piperider":e,s=null===t||void 0===t?void 0:t.tests,a=(null===t||void 0===t?void 0:t.columns)||{};return!s||0===s.length&&0===Object.keys(a).length?(0,f.jsx)(i.kC,{direction:"column",children:(0,f.jsx)(i.xv,{textAlign:"center",children:"No tests available"})}):(0,f.jsx)(i.kC,{direction:"column",gap:4,children:(0,f.jsx)(k.xJ,{children:(0,f.jsxs)(k.iA,{variant:"simple",children:[(0,f.jsx)(k.hr,{children:(0,f.jsxs)(k.Tr,{children:[(0,f.jsx)(k.Th,{children:"Level"}),(0,f.jsx)(k.Th,{children:"Column"}),(0,f.jsx)(k.Th,{children:"Assertion"}),(0,f.jsx)(k.Th,{children:"Status"}),"piperider"===r&&(0,f.jsx)(k.Th,{children:"Expected"}),"piperider"===r&&(0,f.jsx)(k.Th,{children:"Actual"})]})}),(0,f.jsxs)(k.p3,{children:[s.map((function(n){(0,b.h5)(C.S1.safeParse(n));var t="failed"===n.status;return(0,f.jsxs)(k.Tr,{children:[(0,f.jsx)(k.Td,{children:"Table"}),(0,f.jsx)(k.Td,{children:"-"}),(0,f.jsx)(k.Td,{children:n.name}),(0,f.jsx)(k.Td,{children:t?(0,f.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,f.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,f.jsx)(k.Td,{children:(0,v.sG)(n.expected)}),"piperider"===r&&(0,f.jsx)(k.Td,{color:t?"red.500":"inherit",children:(0,v.sG)(n.actual)})]},n.name)})),Object.keys(a).map((function(n){var t=a[n];return(0,b.h5)(O.z.array(C.S1).safeParse(t)),t.map((function(t){var e="failed"===t.status;return(0,f.jsxs)(k.Tr,{children:[(0,f.jsx)(k.Td,{children:"Column"}),(0,f.jsx)(k.Td,{children:n}),(0,f.jsx)(k.Td,{children:t.name}),(0,f.jsx)(k.Td,{children:e?(0,f.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,f.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,f.jsx)(k.Td,{children:(0,v.sG)(t.expected)}),"piperider"===r&&(0,f.jsx)(k.Td,{color:e?"red.500":"inherit",children:(0,v.sG)(t.actual)})]},t.name)}))}))]})]})})})}var w=e(6157);function _(n){var t=n.table;(0,b.h5)(b.vT.safeParse(t));var e=(0,w.YI)(t.piperider_assertion_result,t.dbt_assertion_result);return(0,f.jsxs)(i.kC,{direction:"column",gap:4,mb:8,children:[(0,f.jsx)(i.X6,{size:"lg",children:"Overview"}),(0,f.jsxs)(i.xv,{children:["Table:"," ",(0,f.jsx)(i.xv,{as:"span",fontWeight:700,children:t.name})]}),(0,f.jsxs)(i.xv,{children:["Rows:"," ",(0,f.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,v.uf)(t.row_count)})]}),(0,f.jsxs)(i.xv,{children:["Columns:"," ",(0,f.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,v.uf)(t.col_count)})]}),(0,f.jsxs)(i.xv,{children:["Test Status:"," ",(0,f.jsx)(i.xv,{as:"span",fontWeight:700,children:e.passed})," ","Passed,"," ",(0,f.jsx)(i.xv,{as:"span",fontWeight:700,color:e.failed>0?"red.500":"inherit",children:e.failed})," ","Failed"]})]})}function P(n){var t=n.data,e=n.name,d=t.datasource,c=t.tables[e];return(0,b.h5)(b.vT.safeParse(c)),(0,b.h5)(C.U0.safeParse(d)),(0,o.j)(e),t?(0,f.jsx)(l.o,{children:(0,f.jsxs)(i.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,f.jsx)(i.kC,{mx:"10%",mt:4,children:(0,f.jsxs)(r.aG,{fontSize:"lg",children:[(0,f.jsx)(r.gN,{children:(0,f.jsx)(a.rU,{href:"/",children:(0,f.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:d.name})})}),(0,f.jsx)(r.gN,{isCurrentPage:!0,children:(0,f.jsx)(r.At,{href:"#",children:c.name})})]})}),(0,f.jsxs)(i.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,f.jsx)(_,{table:c}),(0,f.jsxs)(s.mQ,{isLazy:!0,children:[(0,f.jsxs)(s.td,{children:[(0,f.jsx)(s.OK,{children:"Profiling"}),(0,f.jsx)(s.OK,{"data-cy":"sr-report-tab-item",children:"Tests"}),c.dbt_assertion_result&&(0,f.jsx)(s.OK,{children:"dbt Tests"})]}),(0,f.jsxs)(s.nP,{children:[(0,f.jsx)(s.x4,{children:(0,f.jsx)(T,{data:c.columns})}),(0,f.jsx)(s.x4,{children:(0,f.jsx)($,{assertionData:c.piperider_assertion_result})}),(null===c||void 0===c?void 0:c.dbt_assertion_result)&&(0,f.jsx)(s.x4,{children:(0,f.jsx)($,{type:"dbt",assertionData:c.dbt_assertion_result})})]})]})]})]})}):(0,f.jsx)(l.o,{children:(0,f.jsx)(i.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(n,t,e){e.d(t,{H:function(){return o}});var i=e(6523),r=e(1971),s=e(922),a=e(511),l=e(184);function o(n){var t=n.baseColumn,e=n.targetColumn;if(t){(0,i.h5)(i.a$.safeParse(t));var o=(0,s.gQ)(t),d=o.totalOfTotal,c=o.valid,u=o.total,v=o.mismatch,h=o.missing,f=o.mismatchOfTotal,x=o.validOfTotal,m=o.missingOfTotal,j=o.distinctOfTotal}if(e){(0,i.h5)(i.a$.safeParse(e));var p=(0,s.gQ)(e),g=p.total,y=p.mismatchOfTotal,b=p.validOfTotal,S=p.missingOfTotal,T=p.distinctOfTotal}var k=null===e,C="-";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.$,{name:"Total",firstSlot:(0,r.uy)(u,r.uf),secondSlot:k?C:(0,r.uy)(e?g:d,e?r.uf:r.Zn)}),(0,l.jsx)(a.$,{name:"Valid",firstSlot:(0,r.uy)(e?x:c,e?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(e?b:x,r.Zn)}),(0,l.jsx)(a.$,{name:"Mismatched",firstSlot:(0,r.uy)(e?f:v,e?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(e?y:f,r.Zn)}),(0,l.jsx)(a.$,{name:"Missing",firstSlot:(0,r.uy)(e?m:h,e?r.Zn:r.uf),secondSlot:k?C:(0,r.uy)(e?S:m,r.Zn)}),(0,l.jsx)(a.$,{name:"Distinct",firstSlot:(0,r.uy)(null===t||void 0===t?void 0:t.distinct,r.uf),secondSlot:k?C:(0,r.uy)(e?T:j,r.Zn)})]})}},511:function(n,t,e){e.d(t,{$:function(){return s}});var i=e(8735),r=e(184);function s(n){var t=n.name,e=n.firstSlot,s=n.secondSlot,a=n.firstSlotWidth,l=void 0===a?"100px":a,o=n.secondSlotWidth,d=void 0===o?"100px":o;return(0,r.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,r.jsx)(i.xv,{fontWeight:700,children:t}),(0,r.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(i.xv,{textAlign:"right",width:l,noOfLines:1,children:e}),s&&(0,r.jsx)(i.xv,{textAlign:"right",width:d,children:s})]})]})}},8662:function(n,t,e){e.d(t,{D:function(){return o}});var i=e(8735),r=e(6523),s=e(1971),a=e(511),l=e(184);function o(n){var t=n.baseColumn,e=n.targetColumn,o=null===e,d=void 0===e,c="-";return(0,r.h5)(r.a$.safeParse(t)),(0,r.h5)(r.a$.safeParse(t)),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Average",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.avg,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.avg,s.uf)}),(0,l.jsx)(a.$,{name:"Std. Deviation",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.stddev,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.stddev,s.uf)})]}),(0,l.jsxs)(i.kC,{direction:"column",children:[(0,l.jsx)(a.$,{name:"Min",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.min,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.min,s.uf)}),(0,l.jsx)(a.$,{name:"5%",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.p5,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.p5,s.uf)}),(0,l.jsx)(a.$,{name:"25%",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.p25,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.p25,s.uf)}),(0,l.jsx)(a.$,{name:"50%",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.p50,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.p50,s.uf)}),(0,l.jsx)(a.$,{name:"75%",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.p75,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.p75,s.uf)}),(0,l.jsx)(a.$,{name:"95%",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.p95,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.p95,s.uf)}),(0,l.jsx)(a.$,{name:"Max",firstSlot:(0,s.uy)(null===t||void 0===t?void 0:t.max,s.uf),secondSlot:o?c:d?void 0:(0,s.uy)(null===e||void 0===e?void 0:e.max,s.uf)})]})]})}},8453:function(n,t,e){e.d(t,{y:function(){return s}});var i=e(885),r=e(2791);function s(n){var t=(0,r.useState)(null),e=(0,i.Z)(t,2),s=e[0],a=e[1];return(0,r.useEffect)((function(){if(n&&n.current){var t=n.current,e=new ResizeObserver((function(n){n.forEach((function(n){a(n.contentRect)}))}));return e.observe(t),function(){e.unobserve(t)}}}),[n]),s}},9842:function(n,t,e){e.d(t,{v:function(){return u}});var i=e(5251),r="var(--chakra-space-2)",s="var(--chakra-space-2)",a="var(--chakra-space-4)",l="var(--chakra-space-4)",o="var(--chakra-radii-md)",d="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function u(n){var t=n.target,e=n.style,u=void 0===e?{}:e;return i.Ys(t).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===u||void 0===u?void 0:u.paddingTop)||r).style("padding-bottom",(null===u||void 0===u?void 0:u.paddingBottom)||s).style("border-radius",(null===u||void 0===u?void 0:u.borderRadius)||o).style("padding-left",(null===u||void 0===u?void 0:u.paddingLeft)||a).style("padding-right",(null===u||void 0===u?void 0:u.paddingRight)||l).style("color",(null===u||void 0===u?void 0:u.color)||d).style("background-color",(null===u||void 0===u?void 0:u.backgroundColor)||c)}},922:function(n,t,e){e.d(t,{Fo:function(){return l},NN:function(){return a},WN:function(){return s},gQ:function(){return o}});var i=e(2982),r=e(885);function s(n,t){var e={};return Object.entries(n||{}).forEach((function(n){var t=(0,r.Z)(n,2),i=t[0],s=t[1];e[i]||(e[i]={}),e[i].base=s})),Object.entries(t||{}).forEach((function(n){var t=(0,r.Z)(n,2),i=t[0],s=t[1];e[i]||(e[i]={}),e[i].target=s})),e}function a(n){var t=n.base,e=n.target,r=new Map;if(!t||!e)return null;var s=t.labels.map((function(n,e){return r.set(n||String(e),e),{label:n,base:t.counts[e],target:0}}));return e.labels.reduce((function(n,t,s){var a=t||String(s),l=r.has(a),o=e.counts[s];if(l)return n[r.get(a)].target=o,n;var d={label:t,base:0,target:o};return[].concat((0,i.Z)(n),[d])}),s)}function l(n){var t=n.baseCounts,e=n.baseLabels;return t.map((function(n,t){return{label:e[t],base:n,target:0}}))}function o(n){var t=n.non_nulls,e=n.total,i=n.mismatched||0,r=t-i,s=e-t;return{hasNoNull:t===e,mismatch:i,valid:r,missing:s,distinctOfTotal:n.distinct/e,validOfTotal:r/e,mismatchOfTotal:i/e,missingOfTotal:s/e,totalOfTotal:e/e,total:e}}}}]);
//# sourceMappingURL=16.65e6fd27.chunk.js.map