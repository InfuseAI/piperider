"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[860],{860:function(e,n,r){r.r(n),r.d(n,{default:function(){return w}});var t=r(1340),s=r(6831),i=r(9611),a=r(2791);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},c.apply(this,arguments)}function l(e,n){if(null==e)return{};var r,t,s={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}var d=["spacing"],x=["isCurrentPage","as","className","href"],o=["isCurrentPage","separator","isLastChild","spacing","children","className"],h=["children","spacing","separator","className"],u=(0,t.eC)("Breadcrumb"),j=u[0],p=u[1],m=(0,t.Gp)((function(e,n){var r=e.spacing,s=l(e,d),i=c({mx:r},p().separator);return a.createElement(t.m$.span,c({ref:n,role:"presentation"},s,{__css:i}))}));s.Ts&&(m.displayName="BreadcrumbSeparator");var f=(0,t.Gp)((function(e,n){var r=e.isCurrentPage,i=e.as,d=e.className,o=e.href,h=l(e,x),u=p(),j=c({ref:n,as:i,className:(0,s.cx)("chakra-breadcrumb__link",d)},h);return r?a.createElement(t.m$.span,c({"aria-current":"page",__css:u.link},j)):a.createElement(t.m$.a,c({__css:u.link,href:o},j))}));s.Ts&&(f.displayName="BreadcrumbLink");var v=(0,t.Gp)((function(e,n){var r=e.isCurrentPage,d=e.separator,x=e.isLastChild,h=e.spacing,u=e.children,j=e.className,v=l(e,o),g=(0,i.WR)(u).map((function(e){return e.type===f?a.cloneElement(e,{isCurrentPage:r}):e.type===m?a.cloneElement(e,{spacing:h,children:e.props.children||d}):e})),b=c({display:"inline-flex",alignItems:"center"},p().item),y=(0,s.cx)("chakra-breadcrumb__list-item",j);return a.createElement(t.m$.li,c({ref:n,className:y},v,{__css:b}),g,!x&&a.createElement(m,{spacing:h},d))}));s.Ts&&(v.displayName="BreadcrumbItem");var g=(0,t.Gp)((function(e,n){var r=(0,t.jC)("Breadcrumb",e),d=(0,t.Lr)(e),x=d.children,o=d.spacing,u=void 0===o?"0.5rem":o,p=d.separator,m=void 0===p?"/":p,f=d.className,v=l(d,h),g=(0,i.WR)(x),b=g.length,y=g.map((function(e,n){return a.cloneElement(e,{separator:m,spacing:u,isLastChild:b===n+1})})),C=(0,s.cx)("chakra-breadcrumb",f);return a.createElement(t.m$.nav,c({ref:n,"aria-label":"breadcrumb",className:C,__css:r.container},v),a.createElement(j,{value:r},a.createElement(t.m$.ol,{className:"chakra-breadcrumb__list"},y)))}));s.Ts&&(g.displayName="Breadcrumb");var b=r(8735),y=r(7005),C=r(8181),k=r(8625),T=r(7420),N=r(8320),_=r(2527),W=r(184);function w(e){var n=e.source,r=e.data,t=e.reportName;if((0,_.j)(t),!r)return(0,W.jsx)(T.o,{children:(0,W.jsx)(b.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})});var s=r.assertion_results,i=(0,N.c6)(s);return(0,W.jsx)(T.o,{alignItems:"flex-start",children:(0,W.jsxs)(b.kC,{direction:"column",minH:"100vh",width:"100%",children:[(0,W.jsx)(b.kC,{mx:"10%",mt:4,children:(0,W.jsxs)(g,{fontSize:"lg",children:[(0,W.jsx)(v,{children:(0,W.jsx)(k.rU,{href:"/",children:(0,W.jsx)(f,{href:"/",children:n.name})})}),(0,W.jsx)(v,{isCurrentPage:!0,children:(0,W.jsx)(f,{href:"#",children:r.name})})]})}),(0,W.jsxs)(b.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,W.jsxs)(b.kC,{direction:"column",gap:4,children:[(0,W.jsx)(b.X6,{size:"lg",children:"Overview"}),(0,W.jsxs)(b.xv,{children:["Table:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:r.name})]}),(0,W.jsxs)(b.xv,{children:["Rows:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:r.row_count})]}),(0,W.jsxs)(b.xv,{children:["Columns:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:r.col_count})]}),(0,W.jsxs)(b.xv,{children:["Test Status:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:i.passed})," ","Passed,"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,color:i.failed>0?"red.500":"inherit",children:i.failed})," ","Failed"]}),(0,W.jsxs)(b.xv,{children:["Data Source Type:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:n.type})]}),(0,W.jsxs)(b.xv,{children:["Created Date:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:(null===r||void 0===r?void 0:r.created_at)&&(0,C.Z)(new Date(r.created_at),"yyyy/MM/dd HH:mm:ss")})]}),(0,W.jsxs)(b.xv,{children:["Freshness:"," ",(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:"Not applicable"})]})]}),(0,W.jsx)(b.iz,{my:6}),(0,W.jsxs)(b.kC,{direction:"column",children:[(0,W.jsx)(E,{tableName:r.name,data:r.assertion_results}),(0,W.jsx)(O,{data:r.columns})]})]})]})})}function O(e){var n=e.data;return(0,W.jsxs)(b.kC,{direction:"column",gap:4,mt:4,children:[(0,W.jsx)(b.X6,{size:"lg",children:"Profiling"}),Object.keys(n).map((function(e){var r=n[e],t=r.distribution,s=r.non_nulls===r.total;return(0,W.jsxs)(b.kC,{direction:"column",px:4,children:[(0,W.jsxs)(b.rj,{my:4,templateColumns:"300px 1fr",gap:4,children:[(0,W.jsxs)(b.kC,{direction:"column",gap:2,children:[(0,W.jsxs)(b.xv,{children:[(0,W.jsx)(b.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"xl",mr:1,children:r.name}),"","(",(0,W.jsx)(b.EK,{children:r.type}),")"]}),(0,W.jsxs)(b.kC,{direction:"column",children:[(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Total:"}),(0,W.jsx)(b.xv,{children:r.total})]}),(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Missing:"}),(0,W.jsxs)(b.xv,{color:s?"green.500":"red.500",children:[s?"0":(100*Number((r.total-r.non_nulls)/r.total)).toFixed(3),"%"]})]}),(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Distinct:"}),(0,W.jsx)(b.xv,{children:r.distinct})]})]}),"numeric"===r.type&&(0,W.jsxs)(b.kC,{direction:"column",children:[(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Min:"}),(0,W.jsx)(b.xv,{children:Number(r.min).toFixed(3)})]}),(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Max:"}),(0,W.jsx)(b.xv,{children:Number(r.max).toFixed(3)})]}),(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Avg:"}),(0,W.jsx)(b.xv,{children:Number(r.avg).toFixed(3)})]})]}),"datetime"===r.type&&(0,W.jsxs)(b.kC,{direction:"column",children:[(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Min:"}),(0,W.jsx)(b.xv,{children:r.min})]}),(0,W.jsxs)(b.kC,{justifyContent:"space-between",children:[(0,W.jsx)(b.xv,{fontWeight:700,children:"Max:"}),(0,W.jsx)(b.xv,{children:r.max})]})]})]}),(0,W.jsx)(b.kC,{mt:8,children:t?(0,W.jsx)(S,{data:t.labels.map((function(e,n){return{label:e,value:t.counts[n],total:r.total}}))}):(0,W.jsx)(S,{data:[]})})]}),(0,W.jsx)(b.iz,{my:4})]},e)}))]})}function E(e){var n=e.tableName,r=e.data,t=(null===r||void 0===r?void 0:r.tests)||[],s=(null===r||void 0===r?void 0:r.columns)||{};return(0,W.jsxs)(b.kC,{direction:"column",gap:4,children:[(0,W.jsx)(b.X6,{size:"lg",children:"Tests"}),(0,W.jsx)(y.xJ,{children:(0,W.jsxs)(y.iA,{variant:"simple",children:[(0,W.jsx)(y.hr,{children:(0,W.jsxs)(y.Tr,{children:[(0,W.jsx)(y.Th,{children:"Name"}),(0,W.jsx)(y.Th,{children:"Status"}),(0,W.jsx)(y.Th,{children:"Level"}),(0,W.jsx)(y.Th,{children:"Assertion"}),(0,W.jsx)(y.Th,{children:"Expected"}),(0,W.jsx)(y.Th,{children:"Actual"})]})}),(0,W.jsxs)(y.p3,{children:[t.map((function(e){var r="failed"===e.status;return(0,W.jsxs)(y.Tr,{children:[(0,W.jsxs)(y.Td,{children:[(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:n})," "]}),(0,W.jsx)(y.Td,{children:r?(0,W.jsx)(b.xv,{as:"span",role:"img",children:"\u274c"}):(0,W.jsx)(b.xv,{as:"span",role:"img",children:"\u2705"})}),(0,W.jsx)(y.Td,{children:"Table"}),(0,W.jsx)(y.Td,{children:e.name.replace("assert_","")}),(0,W.jsx)(y.Td,{children:"object"===typeof e.expected?Object.keys(e.expected).map((function(n){return(0,W.jsx)(b.xv,{children:"string"===typeof e.expected[n]?e.expected[n]:JSON.stringify(e.expected[n])},n)})):e.expected}),(0,W.jsx)(y.Td,{color:r&&"red.500",children:"object"===typeof e.actual?Object.keys(e.actual).map((function(n){return(0,W.jsx)(b.xv,{children:"string"===typeof e.actual[n]?e.actual[n]:JSON.stringify(e.actual[n])},n)})):e.actual})]},e.name)})),Object.keys(s).map((function(e){return s[e].map((function(n){var r="failed"===n.status;return(0,W.jsxs)(y.Tr,{children:[(0,W.jsxs)(y.Td,{children:[(0,W.jsx)(b.xv,{as:"span",fontWeight:700,children:e})," "]}),(0,W.jsx)(y.Td,{children:r?(0,W.jsx)(b.xv,{as:"span",role:"img",children:"\u274c"}):(0,W.jsx)(b.xv,{as:"span",role:"img",children:"\u2705"})}),(0,W.jsx)(y.Td,{children:"Column"}),(0,W.jsx)(y.Td,{children:n.name.replace("assert_","")}),(0,W.jsx)(y.Td,{children:"object"===typeof n.expected?Object.keys(n.expected).map((function(e){return(0,W.jsx)(b.xv,{children:"string"===typeof n.expected[e]?n.expected[e]:JSON.stringify(n.expected[e])},e)})):n.expected}),(0,W.jsx)(y.Td,{color:r&&"red.500",children:"object"===typeof n.actual?Object.keys(n.actual).map((function(e){return(0,W.jsx)(b.xv,{children:"string"===typeof n.actual[e]?n.actual[e]:JSON.stringify(n.actual[e])},e)})):n.actual})]},n.name)}))}))]})]})})]})}function S(e){var n=e.data,r=(0,a.useRef)(null),t=(0,a.useRef)(null);return(0,a.useEffect)((function(){n.length>0&&(0,N.fN)({containerWidth:t.current.getBoundingClientRect().width,containerHeight:t.current.getBoundingClientRect().height,svgTarget:r.current,tooltipTarget:".chart",data:n})}),[n]),(0,W.jsx)(b.kC,{className:"chart",width:"100%",ref:t,children:(0,W.jsx)("svg",{ref:r})})}}}]);
//# sourceMappingURL=860.e00e3849.chunk.js.map